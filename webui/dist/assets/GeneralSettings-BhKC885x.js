import{d as Je,r as p,N as W,p as Xe,o as Ze,c as h,h as l,b as t,n as ke,l as I,j as N,w as s,e as k,F,f as w,z as g,x as d,a8 as Ve,i as r,W as Ce,a9 as ze,aa as ce,ab as ge,a1 as M,R as te,ac as et,ad as tt,t as C,u as _e,v as st,k as se,$ as lt,M as at,D as ot,ae as Ue,af as Ie,P as nt,g as u,B as rt,q as it,m as dt}from"./index-BjUns_Ha.js";const ut={class:"settings-container"},pt={class:"settings-grid"},ct={class:"card-header"},gt={class:"header-content"},_t={class:"card-content"},mt={class:"password-hint"},ft={class:"settings-card glass-card glass-rounded glass-transparent-header glass-transparent-body"},yt={class:"card-header"},vt={class:"header-content"},ht={class:"card-content"},bt={class:"settings-card glass-card glass-rounded glass-transparent-header glass-transparent-body"},xt={class:"card-header"},wt={class:"header-content"},kt={class:"card-content"},Vt={style:{display:"flex","align-items":"center",gap:"15px"}},Ct={style:{flex:"1",display:"flex","flex-direction":"column","justify-content":"center"}},zt={style:{display:"flex",margin:"auto",gap:"20px","justify-content":"center",padding:"15px 0"}},Ut={style:{height:"500px","overflow-y":"auto"}},It={key:0,style:{"text-align":"center",padding:"20px",color:"#999"}},St={key:1},Pt={style:{color:"#999","margin-right":"10px"}},Tt={style:{"margin-left":"10px"}},Nt={style:{"text-align":"right"}},Mt={class:"settings-card glass-card glass-rounded glass-transparent-header glass-transparent-body"},Ft={class:"card-header"},Rt={class:"header-content"},At={class:"card-content"},Et={key:"agsv",class:"credential-section"},Lt={class:"credential-header"},Bt={class:"credential-form"},Yt={key:"other",class:"placeholder-section"},$t={class:"settings-card glass-card glass-rounded glass-transparent-header glass-transparent-body"},jt={class:"card-header"},Dt={class:"header-content"},Gt={class:"card-content"},Kt={style:{display:"flex","align-items":"center",gap:"20px",padding:"15px 0"}},Ot={class:"form-item",style:{"margin-bottom":"16px"}},qt={style:{display:"flex","align-items":"center","justify-content":"space-between","margin-bottom":"6px"}},Wt={class:"form-item",style:{"margin-bottom":"16px"}},Ht={style:{display:"flex","align-items":"center",gap:"12px"}},Qt={class:"settings-card glass-card glass-rounded glass-transparent-header glass-transparent-body"},Jt={class:"card-header"},Xt={class:"header-content"},Zt={class:"card-content"},es={style:{display:"flex","align-items":"center",gap:"12px",width:"100%"}},ts={style:{display:"flex","align-items":"center","justify-content":"space-between",padding:"6px 0"}},ss={style:{display:"flex","align-items":"center",gap:"16px","flex-wrap":"wrap"}},ls={style:{display:"flex","align-items":"center",gap:"12px","flex-wrap":"nowrap",width:"100%","margin-top":"8px"}},as={style:{"margin-top":"8px"}},os={class:"settings-card glass-card glass-rounded glass-transparent-header glass-transparent-body"},ns={class:"card-header"},rs={class:"header-content"},is={class:"card-content"},ds={style:{display:"flex","align-items":"center",gap:"30px"}},us={style:{display:"flex","align-items":"center",gap:"12px"}},ps={style:{display:"flex","align-items":"center",gap:"12px"}},cs={style:{display:"flex","align-items":"center",gap:"10px"}},gs={key:0,style:{display:"flex","flex-wrap":"wrap",gap:"8px"}},_s={style:{display:"flex","align-items":"center",gap:"10px"}},ms={class:"settings-card glass-card glass-rounded glass-transparent-header glass-transparent-body"},fs={class:"card-header"},ys={class:"header-content"},vs={class:"card-content placeholder-content"},hs={style:{"min-height":"300px"}},bs={key:0,style:{"text-align":"center",padding:"40px",color:"var(--el-text-color-secondary)"}},xs={key:1},ws={style:{"margin-bottom":"16px",display:"flex","justify-content":"space-between","align-items":"center"}},ks={style:{color:"var(--el-text-color-regular)"}},Vs={class:"path-tree-container"},Cs={style:{"text-align":"right"}},zs=Je({__name:"GeneralSettings",setup(Us){const H=p(!1),Q=p(!1),me=p("admin"),J=p(!1),f=p({old_password:"",username:"",password:""}),m=W({token:"",path_filter_enabled:!1,selected_paths:[]}),T=p([]),Y=p(!1),$=p(!1),j=p([]),S=p(),D=p([]),fe=p(!1),i=W({image_hoster:"pixhost",agsv_email:"",agsv_password:"",default_downloader:"",auto_add_existing_to_downloader:!0,publish_batch_concurrency_mode:"cpu",publish_batch_concurrency_manual:5}),Se=[{value:"pixhost",label:"Pixhost (免费)"},{value:"agsv",label:"末日图床 (需账号)"}],le=p(!1),z=p(null),ye=p([]),U=p(""),R=p(!1),A=p(""),Pe=()=>{R.value=!R.value,R.value?A.value=U.value:A.value=U.value?"*".repeat(U.value.length):""},Te=a=>{a.length>0&&a.split("").every(o=>o==="*")||(U.value=a,m.token=a)},X=p(!1),G=p([]),ae=p(!1),oe=p(!1),L=W({background_url:""}),ne=p(!1),V=W({anonymous_upload:!0,cspt_ptgen_token:"",ratio_limiter_interval_seconds:1800}),ve=Xe({get:()=>Math.round(V.ratio_limiter_interval_seconds/60),set:a=>{V.ratio_limiter_interval_seconds=a*60}}),Ne=()=>{window.open("https://cspt.top/ptgen.php","_blank")};p(!1);const y=W({category:{enabled:!0,category:""},tags:{enabled:!0,tags:["PT Nexus","站点/{站点名称}"]}}),Z=p(""),he=()=>{const a=Z.value;if(a&&a.trim()){const e=a.trim();y.tags.tags.includes(e)?g.warning("该标签已存在"):(y.tags.tags.push(e),K(),Z.value="")}},Me=a=>{y.tags.tags.splice(a,1),K()},K=async()=>{try{const a={category:y.category,tags:y.tags};console.log("正在保存标签配置:",a);const e=await w.post("/api/config/tags",a);console.log("保存结果:",e.data)}catch(a){const e=a.response?.data?.message||"保存失败。";console.error("保存失败:",e),g.error(e)}},E=async()=>{fe.value=!0;try{const a={image_hoster:i.image_hoster,agsv_email:i.agsv_email,agsv_password:i.agsv_password,default_downloader:i.default_downloader,auto_add_existing_to_downloader:i.auto_add_existing_to_downloader,publish_batch_concurrency_mode:i.publish_batch_concurrency_mode,publish_batch_concurrency_manual:i.publish_batch_concurrency_manual,cspt_ptgen_token:V.cspt_ptgen_token};await w.post("/api/settings/cross_seed",a)}catch(a){const e=a.response?.data?.error||"保存失败。";g.error(e)}finally{fe.value=!1}},Fe=async()=>{le.value=!0;try{const a=await w.get("/api/settings/cross_seed/publish_concurrency_info");a.data?.success&&(z.value=a.data)}catch{}finally{le.value=!1}},Re=()=>{if(i.publish_batch_concurrency_mode==="manual"){const a=Number(i.publish_batch_concurrency_manual||0);(!Number.isFinite(a)||a<1)&&(i.publish_batch_concurrency_manual=z.value?.effective_suggested_concurrency||5)}E()},Ae=()=>{const a=Number(i.publish_batch_concurrency_manual||0);i.publish_batch_concurrency_manual=Math.max(1,Math.floor(a||1)),E()},Ee=async()=>{try{const a=await w.get("/api/auth/status");a.data?.success&&(me.value=a.data.username||"admin",J.value=!!a.data.must_change_password,f.value.username=me.value);const o=(await w.get("/api/settings")).data;if(o.iyuu_token){U.value=o.iyuu_token;const c="*".repeat(o.iyuu_token.length);m.token=c,A.value=c}else U.value="",m.token="",A.value="";o.iyuu_settings&&(m.path_filter_enabled=o.iyuu_settings.path_filter_enabled||!1,m.selected_paths=o.iyuu_settings.selected_paths||[]),Object.assign(i,o.cross_seed||{}),o.ui_settings&&o.ui_settings.background_url&&(L.background_url=o.ui_settings.background_url),o.upload_settings&&(V.anonymous_upload=o.upload_settings.anonymous_upload!==!1,V.ratio_limiter_interval_seconds=Number(o.upload_settings.ratio_limiter_interval_seconds)||1800),o.cross_seed&&o.cross_seed.cspt_ptgen_token&&(V.cspt_ptgen_token=o.cross_seed.cspt_ptgen_token),o.tags_config&&(o.tags_config.category&&(y.category.enabled=o.tags_config.category.enabled,y.category.category=o.tags_config.category.category),o.tags_config.tags&&(y.tags.enabled=o.tags_config.tags.enabled,y.tags.tags=o.tags_config.tags.tags||[]));const x=await w.get("/api/downloaders_list");ye.value=x.data,await Fe(),m.path_filter_enabled&&await O()}catch{g.error("无法加载设置。")}},Le=a=>{const e=[],o=new Map;return a.sort().forEach(x=>{const c=x.replace(/^\/|\/$/g,"").split("/");let b="",_=e;c.forEach((v,P)=>{if(b=P===0?`/${v}`:`${b}/${v}`,!o.has(b)){const q={path:P===c.length-1?x:b,label:v,children:[]};o.set(b,q),_.push(q)}_=o.get(b).children})}),o.forEach(x=>{x.children&&x.children.length===0&&delete x.children}),e},O=async()=>{Y.value=!0;try{const a=await w.get("/api/paths");a.data.success?(T.value=a.data.paths||[],D.value=Le(T.value)):(g.error(a.data.error||"获取路径列表失败"),T.value=[],D.value=[])}catch(a){const e=a.response?.data?.error||"获取路径列表失败";g.error(e),T.value=[],D.value=[]}finally{Y.value=!1}},be=async()=>{if(!Q.value){Q.value=!0;try{const a={path_filter_enabled:m.path_filter_enabled,selected_paths:m.selected_paths};if(await w.post("/api/iyuu/settings",a),U.value&&m.token!=="********"){const e={iyuu_token:U.value};await w.post("/api/settings",e),R.value=!1;const o=U.value?"*".repeat(U.value.length):"";A.value=o,m.token=o}else if(!U.value&&m.token){const e={iyuu_token:m.token};await w.post("/api/settings",e),U.value=m.token}g.success("IYUU 设置已保存！")}catch(a){const e=a.response?.data?.error||"保存失败。";g.error(e)}finally{Q.value=!1}}},Be=async()=>{try{g.success("IYUU 查询已触发，请稍后查看结果。"),w.post("/api/iyuu/trigger_query").catch(a=>{console.error("IYUU 查询后台执行失败:",a)}),re()}catch(a){const e=a.response?.data?.message||"触发查询失败。";g.error(e)}},re=async()=>{ae.value=!0,X.value=!0;try{const a=await w.get("/api/iyuu/logs");a.data.success?G.value=a.data.logs||[]:(g.error(a.data.message||"获取日志失败"),G.value=[])}catch(a){const e=a.response?.data?.message||"获取日志失败";g.error(e),G.value=[]}finally{ae.value=!1}},Ye=async()=>{if(!H.value){if(!f.value.old_password){g.warning("请填写当前密码");return}if(!f.value.username&&!f.value.password){g.warning("请输入新用户名或新密码");return}if(f.value.username&&f.value.username.trim().length<3){g.warning("用户名至少 3 个字符");return}if(f.value.password&&f.value.password.length<6){g.warning("密码至少 6 位");return}H.value=!0;try{const a={old_password:f.value.old_password};f.value.username&&(a.username=f.value.username),f.value.password&&(a.password=f.value.password);const e=await w.post("/api/auth/change_password",a);e.data?.success?(g.success("保存成功，请重新登录"),localStorage.removeItem("token"),window.location.href="/login"):g.error(e.data?.message||"保存失败")}catch(a){g.error(a?.response?.data?.message||"保存失败")}finally{H.value=!1}}},$e=async()=>{oe.value=!0;try{const a={ui_settings:{background_url:L.background_url}};await w.post("/api/settings",a),g.success("背景设置已保存！"),window.dispatchEvent(new CustomEvent("background-updated",{detail:{backgroundUrl:L.background_url}}))}catch(a){const e=a.response?.data?.error||"保存失败。";g.error(e)}finally{oe.value=!1}},je=async()=>{ne.value=!0;try{const a={anonymous_upload:V.anonymous_upload,ratio_limiter_interval_seconds:Number(V.ratio_limiter_interval_seconds)||1800};await w.post("/api/upload_settings",a);const e={image_hoster:i.image_hoster,agsv_email:i.agsv_email,agsv_password:i.agsv_password,default_downloader:i.default_downloader,auto_add_existing_to_downloader:i.auto_add_existing_to_downloader,cspt_ptgen_token:V.cspt_ptgen_token,publish_batch_concurrency_mode:i.publish_batch_concurrency_mode,publish_batch_concurrency_manual:i.publish_batch_concurrency_manual};await w.post("/api/settings/cross_seed",e),g.success("上传设置已保存！")}catch(a){const e=a.response?.data?.error||"保存失败。";g.error(e)}finally{ne.value=!1}},De=async a=>{a&&T.value.length===0&&await O()},ie=()=>S.value?S.value.getCheckedNodes().filter(e=>!e.children||e.children.length===0).map(e=>e.path):[],Ge=()=>{j.value=ie()},Ke=async()=>{T.value.length===0&&await O(),$.value=!0,await it(),S.value&&(S.value.setCheckedKeys([]),S.value.setCheckedKeys(m.selected_paths))},Oe=()=>{if(S.value){const a=[],e=o=>{o.forEach(x=>{!x.children||x.children.length===0?a.push(x.path):e(x.children)})};e(D.value),S.value.setCheckedKeys(a),j.value=a}},qe=()=>{S.value&&(S.value.setCheckedKeys([]),j.value=[])},We=()=>{m.selected_paths=ie(),$.value=!1,g.success(`已选择 ${m.selected_paths.length} 个路径`),be()};return Ze(()=>{Ee()}),(a,e)=>{const o=k("el-icon"),x=k("el-tag"),c=k("el-button"),b=k("el-input"),_=k("el-form-item"),v=k("el-text"),P=k("el-form"),B=k("el-switch"),q=k("el-dialog"),de=k("el-option"),xe=k("el-select"),we=k("el-input-number"),ue=k("el-radio"),He=k("el-radio-group"),Qe=k("el-tree"),pe=st("loading");return u(),h(F,null,[l("div",ut,[l("div",pt,[l("div",{class:ke(["settings-card glass-card glass-rounded glass-transparent-header glass-transparent-body",{"temp-password-highlight":J.value}])},[l("div",ct,[l("div",gt,[t(o,{class:"header-icon"},{default:s(()=>[t(d(Ve))]),_:1}),e[25]||(e[25]=l("h3",null,"账户信息",-1)),J.value?(u(),I(x,{key:0,type:"danger",size:"small",effect:"dark"},{default:s(()=>[t(o,{style:{"vertical-align":"middle","margin-right":"4px"}},{default:s(()=>[t(d(Ce))]),_:1}),e[24]||(e[24]=r(" 临时密码-请立即修改 ",-1))]),_:1})):N("",!0)]),t(c,{type:"primary",loading:H.value,onClick:Ye,size:"small"},{default:s(()=>[...e[26]||(e[26]=[r(" 保存 ",-1)])]),_:1},8,["loading"])]),l("div",_t,[t(P,{model:f.value,"label-position":"top",class:"settings-form"},{default:s(()=>[t(_,{label:"用户名",class:"form-item"},{default:s(()=>[t(b,{modelValue:f.value.username,"onUpdate:modelValue":e[0]||(e[0]=n=>f.value.username=n),placeholder:"请输入用户名",clearable:""},{prefix:s(()=>[t(o,null,{default:s(()=>[t(d(Ve))]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(_,{label:"当前密码",required:"",class:"form-item"},{default:s(()=>[t(b,{modelValue:f.value.old_password,"onUpdate:modelValue":e[1]||(e[1]=n=>f.value.old_password=n),type:"password",placeholder:"请输入当前密码","show-password":""},{prefix:s(()=>[t(o,null,{default:s(()=>[t(d(ze))]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(_,{label:"新密码",class:"form-item"},{default:s(()=>[t(b,{modelValue:f.value.password,"onUpdate:modelValue":e[2]||(e[2]=n=>f.value.password=n),type:"password",placeholder:"至少 6 位","show-password":""},{prefix:s(()=>[t(o,null,{default:s(()=>[t(d(ce))]),_:1})]),_:1},8,["modelValue"]),l("div",mt,[t(v,{type:"info",size:"small"},{default:s(()=>[...e[27]||(e[27]=[r("留空表示不修改密码",-1)])]),_:1})])]),_:1}),e[29]||(e[29]=l("div",{class:"form-spacer"},null,-1)),J.value?(u(),I(v,{key:0,type:"warning",size:"small",class:"security-hint"},{default:s(()=>[t(o,{size:"12"},{default:s(()=>[t(d(Ce))]),_:1}),e[28]||(e[28]=r(" 为确保安全，请立即设置新用户名与密码 ",-1))]),_:1})):N("",!0)]),_:1},8,["model"])])],2),l("div",ft,[l("div",yt,[l("div",vt,[t(o,{class:"header-icon"},{default:s(()=>[t(d(ge))]),_:1}),e[30]||(e[30]=l("h3",null,"其他设置",-1))]),t(c,{type:"primary",loading:oe.value,onClick:$e,size:"small"},{default:s(()=>[...e[31]||(e[31]=[r(" 保存 ",-1)])]),_:1},8,["loading"])]),l("div",ht,[t(P,{model:L,"label-position":"top",class:"settings-form"},{default:s(()=>[t(_,{label:"背景图片URL",class:"form-item"},{default:s(()=>[t(b,{modelValue:L.background_url,"onUpdate:modelValue":e[3]||(e[3]=n=>L.background_url=n),placeholder:"请输入背景图片的URL地址",clearable:""},{prefix:s(()=>[t(o,null,{default:s(()=>[t(d(ge))]),_:1})]),_:1},8,["modelValue"])]),_:1}),e[33]||(e[33]=l("div",{class:"form-spacer"},null,-1)),t(v,{type:"info",size:"small",class:"proxy-hint"},{default:s(()=>[t(o,{size:"12"},{default:s(()=>[t(d(M))]),_:1}),e[32]||(e[32]=r(" 设置应用程序的背景图片，支持在线图片URL ",-1))]),_:1})]),_:1},8,["model"])])]),l("div",bt,[l("div",xt,[l("div",wt,[t(o,{class:"header-icon"},{default:s(()=>[t(d(te))]),_:1}),e[34]||(e[34]=l("h3",null,"IYUU设置",-1))]),t(c,{type:"primary",loading:Q.value,onClick:be,size:"small"},{default:s(()=>[...e[35]||(e[35]=[r(" 保存 ",-1)])]),_:1},8,["loading"])]),l("div",kt,[t(P,{model:m,"label-position":"top",class:"settings-form"},{default:s(()=>[t(_,{label:"IYUU Token",class:"form-item"},{default:s(()=>[t(b,{modelValue:A.value,"onUpdate:modelValue":e[4]||(e[4]=n=>A.value=n),type:R.value?"text":"password",placeholder:"请输入IYUU Token",onInput:Te},{prefix:s(()=>[t(o,null,{default:s(()=>[t(d(ce))]),_:1})]),suffix:s(()=>[t(o,{onClick:Pe,style:{cursor:"pointer"},class:ke({"is-active":R.value})},{default:s(()=>[R.value?(u(),I(d(tt),{key:1})):(u(),I(d(et),{key:0}))]),_:1},8,["class"])]),_:1},8,["modelValue","type"])]),_:1}),t(_,{label:"查询路径限制",class:"form-item"},{default:s(()=>[l("div",Vt,[t(B,{modelValue:m.path_filter_enabled,"onUpdate:modelValue":e[5]||(e[5]=n=>m.path_filter_enabled=n),"active-text":"启用路径过滤","inactive-text":"禁用路径过滤",onChange:De},null,8,["modelValue"]),m.path_filter_enabled?(u(),I(c,{key:0,type:"primary",size:"small",onClick:Ke},{default:s(()=>[r(" 选择路径 ("+C(m.selected_paths.length)+") ",1)]),_:1})):N("",!0)])]),_:1}),l("div",Ct,[t(_,{label:"",class:"form-item"},{default:s(()=>[l("div",zt,[t(c,{type:"success",onClick:Be,size:"default",style:{"font-size":"14px",padding:"12px 24px"}},{default:s(()=>[...e[36]||(e[36]=[r(" 手动触发查询 ",-1)])]),_:1}),t(c,{type:"primary",onClick:re,size:"default",style:{"font-size":"14px",padding:"12px 24px"}},{default:s(()=>[...e[37]||(e[37]=[r(" 查看日志 ",-1)])]),_:1})])]),_:1}),t(v,{type:"info",size:"small",style:{display:"block","text-align":"center",margin:"10px 0"}},{default:s(()=>[t(o,{size:"12"},{default:s(()=>[t(d(M))]),_:1}),e[38]||(e[38]=r(" 种子查询页面的红色表示可辅种但未在做种 ",-1))]),_:1})]),e[40]||(e[40]=l("div",{class:"form-spacer"},null,-1)),t(v,{type:"info",size:"small",class:"proxy-hint"},{default:s(()=>[t(o,{size:"12"},{default:s(()=>[t(d(M))]),_:1}),e[39]||(e[39]=r(" 用于与IYUU平台进行数据同步和通信的身份验证令牌 ",-1))]),_:1})]),_:1},8,["model"])])]),t(q,{modelValue:X.value,"onUpdate:modelValue":e[7]||(e[7]=n=>X.value=n),title:"IYUU 查询日志",width:"800px",top:"50px"},{footer:s(()=>[l("div",Nt,[t(c,{onClick:e[6]||(e[6]=n=>X.value=!1)},{default:s(()=>[...e[41]||(e[41]=[r("关闭",-1)])]),_:1}),t(c,{type:"primary",onClick:re},{default:s(()=>[...e[42]||(e[42]=[r("刷新",-1)])]),_:1})])]),default:s(()=>[_e((u(),h("div",Ut,[G.value.length===0?(u(),h("div",It," 暂无日志记录 ")):(u(),h("div",St,[(u(!0),h(F,null,se(G.value,(n,ee)=>(u(),h("div",{key:ee,style:{padding:"8px 0","border-bottom":"1px solid #eee","font-size":"12px"}},[l("span",Pt,"["+C(n.timestamp)+"]",1),l("span",{style:rt({color:n.level==="ERROR"?"#F56C6C":n.level==="WARNING"?"#E6A23C":n.level==="INFO"?"#409EFF":"#67C23A"})},"["+C(n.level)+"]",5),l("span",Tt,C(n.message),1)]))),128))]))])),[[pe,ae.value]])]),_:1},8,["modelValue"]),l("div",Mt,[l("div",Ft,[l("div",Rt,[t(o,{class:"header-icon"},{default:s(()=>[t(d(ge))]),_:1}),e[43]||(e[43]=l("h3",null,"图床设置",-1))])]),l("div",At,[t(P,{model:i,"label-position":"top",class:"settings-form"},{default:s(()=>[t(_,{label:"截图图床",class:"form-item"},{default:s(()=>[t(xe,{modelValue:i.image_hoster,"onUpdate:modelValue":e[8]||(e[8]=n=>i.image_hoster=n),placeholder:"请选择图床服务",onChange:E},{default:s(()=>[(u(),h(F,null,se(Se,n=>t(de,{key:n.value,label:n.label,value:n.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),t(lt,{name:"slide",mode:"out-in"},{default:s(()=>[i.image_hoster==="agsv"?(u(),h("div",Et,[l("div",Lt,[t(o,{class:"credential-icon"},{default:s(()=>[t(d(ze))]),_:1}),e[44]||(e[44]=l("span",{class:"credential-title"},"末日图床账号凭据",-1))]),l("div",Bt,[t(_,{label:"邮箱",class:"form-item compact"},{default:s(()=>[t(b,{modelValue:i.agsv_email,"onUpdate:modelValue":e[9]||(e[9]=n=>i.agsv_email=n),placeholder:"请输入邮箱",size:"small",onBlur:E},null,8,["modelValue"])]),_:1}),t(_,{label:"密码",class:"form-item compact"},{default:s(()=>[t(b,{modelValue:i.agsv_password,"onUpdate:modelValue":e[10]||(e[10]=n=>i.agsv_password=n),type:"password",placeholder:"请输入密码","show-password":"",size:"small",onBlur:E},null,8,["modelValue"])]),_:1})])])):(u(),h("div",Yt,[t(v,{type:"info",size:"small"},{default:s(()=>[...e[45]||(e[45]=[r("当前图床无需额外配置，但是需要代理才能上传",-1)])]),_:1})]))]),_:1})]),_:1},8,["model"])])]),l("div",$t,[l("div",jt,[l("div",Dt,[t(o,{class:"header-icon"},{default:s(()=>[t(d(te))]),_:1}),e[46]||(e[46]=l("h3",null,"转种设置",-1))]),t(c,{type:"primary",onClick:je,loading:ne.value,size:"small"},{default:s(()=>[...e[47]||(e[47]=[r(" 保存 ",-1)])]),_:1},8,["loading"])]),l("div",Gt,[t(P,{model:V,"label-position":"top",class:"settings-form"},{default:s(()=>[t(_,{label:"",class:"form-item"},{default:s(()=>[l("div",Kt,[t(B,{modelValue:V.anonymous_upload,"onUpdate:modelValue":e[11]||(e[11]=n=>V.anonymous_upload=n),"active-text":"启用匿名","inactive-text":"禁用匿名"},null,8,["modelValue"])]),t(v,{type:"info",size:"small",style:{display:"block"}},{default:s(()=>[t(o,{size:"12",style:{"vertical-align":"middle","margin-right":"4px"}},{default:s(()=>[t(d(M))]),_:1}),e[48]||(e[48]=r(" 启用后，发布种子时将使用匿名模式，不显示上传者信息 ",-1))]),_:1})]),_:1}),l("div",Ot,[l("div",qt,[e[50]||(e[50]=l("span",{style:{"font-weight":"500",color:"var(--el-text-color-regular)","font-size":"13px"}}," 财神 PTGen API Token（每日100次） ",-1)),t(c,{type:"primary",link:"",onClick:Ne,style:{"white-space":"nowrap"}},{default:s(()=>[t(o,{style:{"margin-right":"4px"}},{default:s(()=>[t(d(at))]),_:1}),e[49]||(e[49]=r(" 获取Token ",-1))]),_:1})]),t(b,{modelValue:V.cspt_ptgen_token,"onUpdate:modelValue":e[12]||(e[12]=n=>V.cspt_ptgen_token=n),type:"password",placeholder:"请输入财神 PTGen API Token","show-password":""},{prefix:s(()=>[t(o,null,{default:s(()=>[t(d(ce))]),_:1})]),_:1},8,["modelValue"]),t(v,{type:"info",size:"small",style:{display:"block","margin-top":"8px"}},{default:s(()=>[t(o,{size:"12",style:{"vertical-align":"middle","margin-right":"4px"}},{default:s(()=>[t(d(M))]),_:1}),e[51]||(e[51]=r(" 配置后优先使用该 API 获取影片信息，每日限量 100+ 次，上限随等级提升，使用完会自动切换内置的其他 PTGen API ",-1))]),_:1})]),l("div",Wt,[l("div",Ht,[e[52]||(e[52]=l("span",{style:{"font-weight":"500",color:"var(--el-text-color-regular)","font-size":"13px"}}," 出种后分享率检测间隔 ",-1)),t(we,{modelValue:ve.value,"onUpdate:modelValue":e[13]||(e[13]=n=>ve.value=n),min:10,max:1440,size:"small",style:{width:"120px"},controls:!0},null,8,["modelValue"]),e[53]||(e[53]=l("span",{style:{color:"var(--el-text-color-regular)","font-size":"13px"}},"分钟",-1))]),t(v,{type:"info",size:"small",style:{display:"block","margin-top":"8px"}},{default:s(()=>[t(o,{size:"12",style:{"vertical-align":"middle","margin-right":"4px"}},{default:s(()=>[t(d(M))]),_:1}),e[54]||(e[54]=r(" 分享率阈值和限速设置请在「站点设置」中为每个站点单独配置 ",-1))]),_:1})]),e[55]||(e[55]=l("div",{class:"form-spacer"},null,-1))]),_:1},8,["model"])])]),l("div",Qt,[l("div",Jt,[l("div",Xt,[t(o,{class:"header-icon"},{default:s(()=>[t(d(ot))]),_:1}),e[56]||(e[56]=l("h3",null,"发种设置",-1))])]),l("div",Zt,[t(P,{model:i,"label-position":"top",class:"settings-form"},{default:s(()=>[t(_,{class:"form-item"},{default:s(()=>[l("div",es,[e[57]||(e[57]=l("span",{style:{"font-weight":"500",color:"var(--el-text-color-regular)","font-size":"13px","white-space":"nowrap"}}," 默认下载器 ",-1)),t(xe,{modelValue:i.default_downloader,"onUpdate:modelValue":e[14]||(e[14]=n=>i.default_downloader=n),placeholder:"使用源种子所在的下载器",clearable:"",onChange:E,style:{flex:"1","min-width":"0"}},{default:s(()=>[t(de,{label:"使用源种子所在的下载器",value:""}),(u(!0),h(F,null,se(ye.value,n=>(u(),I(de,{key:n.id,label:n.name,value:n.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])]),_:1}),e[64]||(e[64]=l("div",{class:"form-spacer"},null,-1)),t(v,{type:"info",size:"small",class:"proxy-hint"},{default:s(()=>[t(o,{size:"12"},{default:s(()=>[t(d(M))]),_:1}),e[58]||(e[58]=r(' 发种完成后自动将种子添加到指定的下载器。选择"使用源种子所在的下载器"或不选择任何下载器，则添加到源种子所在的下载器。 ',-1))]),_:1}),t(_,{class:"form-item"},{default:s(()=>[l("div",ts,[e[59]||(e[59]=l("span",{style:{"font-weight":"500",color:"var(--el-text-color-regular)","font-size":"13px","margin-right":"10px"}}," 目标站点已存在时是否添加到下载器 ",-1)),t(B,{modelValue:i.auto_add_existing_to_downloader,"onUpdate:modelValue":e[15]||(e[15]=n=>i.auto_add_existing_to_downloader=n),onChange:E},null,8,["modelValue"])]),t(v,{type:"info",size:"small",style:{display:"block"}},{default:s(()=>[t(o,{size:"12",style:{"vertical-align":"middle","margin-right":"4px"}},{default:s(()=>[t(d(M))]),_:1}),e[60]||(e[60]=r(' 当目标站点"种子已存在"时，可选择是否继续添加到下载器。 ',-1))]),_:1})]),_:1}),e[65]||(e[65]=l("div",{class:"form-spacer"},null,-1)),t(_,{label:"批量发布并发策略",class:"form-item"},{default:s(()=>[t(He,{modelValue:i.publish_batch_concurrency_mode,"onUpdate:modelValue":e[17]||(e[17]=n=>i.publish_batch_concurrency_mode=n),onChange:Re},{default:s(()=>[l("div",ss,[t(ue,{label:"cpu"},{default:s(()=>[...e[61]||(e[61]=[r("自动（CPU线程数×2）",-1)])]),_:1}),t(ue,{label:"all"},{default:s(()=>[...e[62]||(e[62]=[r("所有站点同时发布",-1)])]),_:1})]),l("div",ls,[t(ue,{label:"manual",style:{"white-space":"nowrap"}},{default:s(()=>[...e[63]||(e[63]=[r("手动设置并发数",-1)])]),_:1}),i.publish_batch_concurrency_mode==="manual"?(u(),I(we,{key:0,modelValue:i.publish_batch_concurrency_manual,"onUpdate:modelValue":e[16]||(e[16]=n=>i.publish_batch_concurrency_manual=n),size:"small",min:1,max:z.value?.max_concurrency||200,style:{width:"150px",height:"25px"},onChange:Ae},null,8,["modelValue","max"])):N("",!0)])]),_:1},8,["modelValue"]),_e((u(),h("div",as,[i.publish_batch_concurrency_mode==="cpu"?(u(),I(v,{key:0,type:"info",size:"small"},{default:s(()=>[r(" 当前服务器 CPU 线程数 "+C(z.value?.cpu_threads??"-")+"，推荐并发 "+C(z.value?.suggested_concurrency??"-")+" ",1),z.value&&z.value.effective_suggested_concurrency!==z.value.suggested_concurrency?(u(),h(F,{key:0},[r(" （受上限 "+C(z.value.max_concurrency)+" 影响，实际将使用 "+C(z.value.effective_suggested_concurrency)+"） ",1)],64)):N("",!0)]),_:1})):i.publish_batch_concurrency_mode==="all"?(u(),I(v,{key:1,type:"info",size:"small"},{default:s(()=>[r(" 将并发等于“本次选择的目标站点数量”（上限 "+C(z.value?.max_concurrency??"-")+"）。 ",1)]),_:1})):(u(),I(v,{key:2,type:"info",size:"small"},{default:s(()=>[r(" 手动并发数将在发布时生效（上限 "+C(z.value?.max_concurrency??"-")+"）。 ",1)]),_:1}))])),[[pe,le.value]])]),_:1})]),_:1},8,["model"])])]),l("div",os,[l("div",ns,[l("div",rs,[t(o,{class:"header-icon"},{default:s(()=>[t(d(Ue))]),_:1}),e[66]||(e[66]=l("h3",null,"下载器标签/分类设置",-1))])]),l("div",is,[t(P,{model:y,"label-position":"top",class:"settings-form"},{default:s(()=>[t(_,{label:"",class:"form-item"},{default:s(()=>[l("div",ds,[l("div",us,[t(o,{size:"20"},{default:s(()=>[t(d(Ue))]),_:1}),e[67]||(e[67]=l("span",{style:{"font-weight":"500","font-size":"14px"}},"标签",-1)),t(B,{modelValue:y.tags.enabled,"onUpdate:modelValue":e[18]||(e[18]=n=>y.tags.enabled=n),onChange:K},null,8,["modelValue"])]),l("div",ps,[t(o,{size:"20"},{default:s(()=>[t(d(Ie))]),_:1}),e[68]||(e[68]=l("span",{style:{"font-weight":"500","font-size":"14px"}},"分类",-1)),t(B,{modelValue:y.category.enabled,"onUpdate:modelValue":e[19]||(e[19]=n=>y.category.enabled=n),onChange:K},null,8,["modelValue"])])])]),_:1}),y.tags.enabled?(u(),h(F,{key:0},[t(_,{label:"自定义标签",class:"form-item",style:{margin:"0"}}),t(_,{label:"",class:"form-item"},{default:s(()=>[l("div",cs,[t(b,{modelValue:Z.value,"onUpdate:modelValue":e[20]||(e[20]=n=>Z.value=n),placeholder:"输入新标签",style:{height:"32px",width:"200px"},onKeyup:nt(he,["enter"])},null,8,["modelValue"]),t(c,{type:"primary",size:"small",onClick:he},{default:s(()=>[...e[69]||(e[69]=[r(" 添加标签 ",-1)])]),_:1})])]),_:1}),t(_,{label:"",class:"form-item"},{default:s(()=>[y.tags.tags.length>0?(u(),h("div",gs,[(u(!0),h(F,null,se(y.tags.tags,(n,ee)=>(u(),I(x,{key:ee,closable:"",onClose:Is=>Me(ee),size:"small"},{default:s(()=>[r(C(n),1)]),_:2},1032,["onClose"]))),128))])):N("",!0)]),_:1})],64)):N("",!0),y.category.enabled?(u(),h(F,{key:1},[t(_,{label:"自定义分类",class:"form-item",style:{margin:"0"}}),t(_,{class:"form-item"},{default:s(()=>[l("div",_s,[t(b,{modelValue:y.category.category,"onUpdate:modelValue":e[21]||(e[21]=n=>y.category.category=n),placeholder:"输入分类名称",size:"small",clearable:"",style:{height:"32px",width:"200px"}},null,8,["modelValue"]),t(c,{type:"primary",size:"small",onClick:K},{default:s(()=>[...e[70]||(e[70]=[r(" 保存 ",-1)])]),_:1})])]),_:1})],64)):N("",!0),e[76]||(e[76]=l("div",{class:"form-spacer"},null,-1)),t(v,{type:"info",size:"small",class:"proxy-hint"},{default:s(()=>[t(o,{size:"12"},{default:s(()=>[t(d(M))]),_:1}),e[71]||(e[71]=r(" 启用标签与分类功能后，会自动为种子添加标签与分类",-1)),e[72]||(e[72]=l("br",null,null,-1)),e[73]||(e[73]=r(' 默认添加"站点/{站点名称}"和"PT Nexus"标签',-1)),e[74]||(e[74]=l("br",null,null,-1)),e[75]||(e[75]=r(" 自定义标签：可以为转种的种子添加自定义标签 ",-1))]),_:1})]),_:1},8,["model"])])]),l("div",ms,[l("div",fs,[l("div",ys,[t(o,{class:"header-icon"},{default:s(()=>[t(d(te))]),_:1}),e[77]||(e[77]=l("h3",null,"功能扩展",-1))])]),l("div",vs,[t(o,{class:"placeholder-icon"},{default:s(()=>[t(d(te))]),_:1}),e[78]||(e[78]=l("p",{class:"placeholder-text"},"功能扩展中",-1))])])])]),l("div",null,[l("div",null,[t(q,{modelValue:$.value,"onUpdate:modelValue":e[23]||(e[23]=n=>$.value=n),title:"选择IYUU查询路径",width:"600px",top:"50px"},{footer:s(()=>[l("div",Cs,[t(c,{onClick:e[22]||(e[22]=n=>$.value=!1)},{default:s(()=>[...e[84]||(e[84]=[r("取消",-1)])]),_:1}),t(c,{type:"primary",onClick:We,disabled:j.value.length===0},{default:s(()=>[r(" 确定选择 ("+C(j.value.length)+") ",1)]),_:1},8,["disabled"])])]),default:s(()=>[_e((u(),h("div",hs,[!Y.value&&T.value.length===0?(u(),h("div",bs,[t(o,{style:{"font-size":"48px","margin-bottom":"16px",opacity:"0.5"}},{default:s(()=>[t(d(Ie))]),_:1}),e[80]||(e[80]=l("p",null,"暂无可用的保存路径",-1)),t(c,{type:"primary",onClick:O,style:{"margin-top":"16px"}},{default:s(()=>[...e[79]||(e[79]=[r(" 刷新路径列表 ",-1)])]),_:1})])):T.value.length>0?(u(),h("div",xs,[l("div",ws,[l("span",ks," 已选择 "+C(ie().length)+" / "+C(T.value.length)+" 个路径 ",1),l("div",null,[t(c,{size:"small",onClick:Oe},{default:s(()=>[...e[81]||(e[81]=[r("全选",-1)])]),_:1}),t(c,{size:"small",onClick:qe},{default:s(()=>[...e[82]||(e[82]=[r("清空",-1)])]),_:1}),t(c,{size:"small",onClick:O,loading:Y.value},{default:s(()=>[...e[83]||(e[83]=[r("刷新",-1)])]),_:1},8,["loading"])])]),l("div",Vs,[t(Qe,{ref_key:"pathTreeRef",ref:S,data:D.value,"show-checkbox":"","node-key":"path","default-expand-all":"","expand-on-click-node":!1,"check-on-click-node":"","check-strictly":!0,props:{class:"path-tree-node"},onCheck:Ge},null,8,["data"])])])):N("",!0)])),[[pe,Y.value]])]),_:1},8,["modelValue"])])])],64)}}}),Ps=dt(zs,[["__scopeId","data-v-ff889299"]]);export{Ps as default};
