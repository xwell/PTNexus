import{d as Ot,r as g,p as H,o as xt,s as Ut,O as Dt,c as _,l as M,j as C,h as r,e as b,b as s,w as a,i as o,t as f,x as Et,R as _s,u as st,v as Jt,F as Te,k as Ae,L as Ct,f as $,z as y,q as qt,g as p,m as jt,Q as Lt,n as ae,B as vs,S as ms}from"./index-BjUns_Ha.js";import{u as hs,C as ys}from"./CrossSeedPanel-kOKAqKT1.js";const ws={class:"batch-fetch-panel"},bs={class:"search-and-controls"},ks={key:0,class:"current-filters",style:{"margin-right":"15px",display:"flex","align-items":"center"}},Ss={key:2,class:"pagination-controls"},xs={class:"table-container"},Ds=["title"],Cs={key:0,style:{color:"#909399"}},$s={class:"filter-card-header"},Ts={class:"filter-card-body"},zs={class:"path-tree-container"},Is={class:"filter-card-footer"},Rs={key:2,class:"modal-overlay"},Bs={class:"modal-header"},Vs={class:"batch-fetch-content"},Fs={class:"config-section"},Ps={class:"batch-fetch-footer"},Ms={key:3,class:"modal-overlay"},Ns={class:"modal-header"},As={class:"priority-settings-content"},Ls={class:"priority-section"},Os={class:"priority-list"},Us={key:0,style:{color:"#909399","margin-left":"10px"}},Es={class:"priority-settings-footer"},Js={key:4,class:"modal-overlay"},qs={class:"modal-header"},js={class:"progress-header-controls"},Xs={class:"progress-content"},Hs={class:"progress-summary"},Ws={key:0,class:"bdinfo-stats"},Ks={class:"results-table-container"},Ys={class:"progress-footer"},Gs=3e3,Qs=Ot({__name:"BatchFetchPanel",emits:["cancel","fetch-completed"],setup(Xt,{emit:at}){const lt=at,ze=g([]),de=g(!0),le=g(null),Y=g([]),ie=g(!1),B=g(!1),ke=g(!1),Se=g(!1),q=g(!1),O=g([]),U=g(null),ue=g(null),ce=g([]),E=g([]),G=g([]),Xe=g([]),j=g(1),pe=g(20),T=g(0),Q=g(""),Z=g(!1),F=g({paths:[],states:[],downloaderIds:[],sourceSiteAvailability:[]}),J=g({...F.value}),ne=g(null),k=g({total:0,processed:0,success:0,failed:0,skipped:0,isRunning:!1,results:[]}),xe=g(null),nt=H(()=>{const d=F.value,n=[];return d.sourceSiteAvailability&&d.sourceSiteAvailability.length>0&&n.push(`源站点: ${d.sourceSiteAvailability.length}`),d.paths&&d.paths.length>0&&n.push(`路径: ${d.paths.length}`),d.states&&d.states.length>0&&n.push(`状态: ${d.states.length}`),d.downloaderIds&&d.downloaderIds.length>0&&n.push(`下载器: ${d.downloaderIds.length}`),n.join(", ")}),He=H(()=>{const d=F.value;return d.sourceSiteAvailability&&d.sourceSiteAvailability.length>0||d.paths&&d.paths.length>0||d.states&&d.states.length>0||d.downloaderIds&&d.downloaderIds.length>0}),W=g([]),fe=async()=>{try{const d=await $.get("/api/sites/status");W.value=d.data}catch(d){console.error("加载站点状态失败:",d)}},We=H(()=>k.value.total===0?0:Math.round(k.value.processed/k.value.total*100)),ge=H(()=>{if(!k.value.isRunning)return k.value.failed>0?"exception":"success"}),De=d=>{const n=[],w=new Map;return d.sort().forEach(m=>{const v=m.replace(/^\/|\/$/g,"").split("/");let x="",te=n;v.forEach((K,R)=>{if(x=R===0?`/${K}`:`${x}/${K}`,!w.has(x)){const P={path:R===v.length-1?m:x,label:K,children:[]};w.set(x,P),te.push(P)}te=w.get(x).children})}),w.forEach(m=>{m.children&&m.children.length===0&&delete m.children}),n},_e=async()=>{de.value=!0,le.value=null;try{const d=new URLSearchParams({page:j.value.toString(),pageSize:pe.value.toString(),nameSearch:Q.value,path_filters:JSON.stringify(F.value.paths),state_filters:JSON.stringify(F.value.states),downloader_filters:JSON.stringify(F.value.downloaderIds),source_availability_filters:JSON.stringify(F.value.sourceSiteAvailability),exclude_existing:"true",only_completed:"true"}),w=(await $.get(`/api/data?${d.toString()}`)).data;w.error?(le.value=w.error||"获取数据失败",y.error(w.error||"获取数据失败")):(ze.value=w.data.map(m=>({name:m.name,save_path:m.save_path,size:m.size,progress:m.progress,state:m.state,sites:m.sites||{},downloader_ids:m.downloader_ids||[]})),T.value=w.total,(G.value.length===0||!F.value.states.length)&&(G.value=[...new Set(ze.value.map(m=>m.state))]))}catch(d){le.value=d.message||"网络错误",y.error(d.message||"网络错误")}finally{de.value=!1}},ot=async()=>{try{const n=(await $.get("/api/all_downloaders")).data;Xe.value=n.filter(w=>w.enabled)}catch(d){le.value=d.message}},rt=async()=>{try{const d=new URLSearchParams({page:"1",page_size:"1",path_filters:JSON.stringify([]),state_filters:JSON.stringify([]),downloader_filters:JSON.stringify([]),source_availability_filters:JSON.stringify([])}),w=(await $.get(`/api/data?${d.toString()}`)).data;w.unique_paths&&(E.value=w.unique_paths,ce.value=De(E.value))}catch(d){console.error("获取路径列表失败:",d)}},it=d=>{pe.value=d,j.value=1,_e()},dt=d=>{j.value=d,_e()},ve=()=>{F.value={paths:[],states:[],downloaderIds:[],sourceSiteAvailability:[]},Q.value="",j.value=1,Ie(),_e()},z=()=>{J.value={...F.value},Z.value=!0,qt(()=>{ue.value&&F.value.paths.length>0&&ue.value.setCheckedKeys(F.value.paths,!1)})},oe=()=>{if(ue.value){const d=ue.value.getCheckedKeys(!1);J.value.paths=d}F.value={...J.value},Z.value=!1,j.value=1,Ie(),_e()},Ie=async()=>{try{await $.post("/api/config/batch_fetch_filters",{batch_fetch_filters:F.value,batch_fetch_name_search:Q.value})}catch(d){console.error("保存筛选条件失败:",d)}},Re=async()=>{try{const n=(await $.get("/api/config/batch_fetch_filters")).data;if(n.success&&n.data){const w={paths:[],states:[],downloaderIds:[],sourceSiteAvailability:[]};F.value={...w,...n.data}}n.success&&n.name_search!==void 0&&(Q.value=n.name_search)}catch(d){console.error("加载筛选条件失败:",d)}},ut=d=>{Y.value=d},ee=d=>{const n={},w=new Set(["我堡","OurBits"]);for(const[m,v]of Object.entries(d||{}))w.has(m)||(v.migration===1||v.migration===3)&&W.value.find(x=>x.name===m)?.has_cookie&&(n[m]=v);return n},X=()=>{if(Y.value.length===0){y.warning("请先选择要获取数据的种子");return}ie.value=!0},N=()=>{ie.value=!1},ct=async()=>{ke.value=!0,await pt()},Le=()=>{ke.value=!1},pt=async()=>{Se.value=!0;try{const n=(await $.get("/api/sites/status")).data,w=new Set(["我堡","OurBits"]),m=n.filter(L=>L.is_source&&L.has_cookie&&!w.has(L.name)),x=(await $.get("/api/config/source_priority")).data,te=x.success?x.data||[]:[],K=[],R=new Set;te.forEach(L=>{if(w.has(L))return;const P=m.find(Ue=>Ue.name===L);P&&!R.has(P.name)&&(K.push(P),R.add(P.name))}),m.forEach(L=>{R.has(L.name)||K.push(L)}),O.value=K}catch(d){y.error(d.message||"加载配置失败")}finally{Se.value=!1}},Be=async()=>{q.value=!0;try{const d=new Set(["我堡","OurBits"]),n=O.value.map(m=>m.name).filter(m=>!d.has(m)),w=await $.post("/api/config/source_priority",{source_priority:n});if(w.data.success)y.success("源站点优先级配置已保存"),Le();else throw new Error(w.data.message||"保存失败")}catch(d){y.error(d.message||"保存配置失败")}finally{q.value=!1}},Ke=d=>d===0?"success":d===1?"primary":d===2?"warning":"info",ft=d=>{U.value=d},A=d=>{if(U.value===null)return;const n=O.value[U.value];O.value.splice(U.value,1),O.value.splice(d,0,n),U.value=null},Ve=async()=>{try{const d=Y.value.filter(v=>Object.keys(ee(v.sites)).length===0).length;d>0&&y.info(`选中 ${d} 个无可用源站点的种子，将自动尝试通过 IYUU 批量补全站点信息（如已配置）`);const n=Y.value.map(v=>v.name),m=(await $.post("/api/migrate/batch_fetch_seed_data",{torrentNames:n})).data;m.success?(ne.value=m.task_id,y.success("批量获取任务已启动"),N(),Ye()):y.error(m.message||"批量获取任务启动失败")}catch(d){const n=d.response?.data?.message||d.message||"网络错误";y.error(n)}},Ye=()=>{B.value=!0,gt()},Ge=()=>{B.value=!1,me()},gt=()=>{me(),Oe(),xe.value=setInterval(async()=>{B.value&&ne.value?(await Oe(),k.value&&!k.value.isRunning&&setTimeout(()=>{k.value.isRunning||me()},3e3)):me()},Gs)},me=()=>{xe.value&&(clearInterval(xe.value),xe.value=null)},Oe=async()=>{if(ne.value)try{const n=(await $.get(`/api/migrate/batch_fetch_progress?task_id=${ne.value}`)).data;if(n.success){const w=k.value.isRunning;if(k.value=n.progress,k.value.results&&k.value.results.length>0){const m={processing:k.value.results.filter(v=>v.bdinfo_status==="processing_bdinfo"||v.mediainfo&&v.mediainfo.includes("正在处理 BDInfo")).length,completed:k.value.results.filter(v=>v.bdinfo_status==="completed"||v.mediainfo&&v.mediainfo.includes("DISC INFO")).length,failed:k.value.results.filter(v=>v.bdinfo_status==="failed"||v.mediainfo&&v.mediainfo.includes("bdinfo提取失败")).length};k.value.bdinfo_stats=m}w&&!k.value.isRunning&&lt("fetch-completed")}else y.error(n.message||"获取进度失败")}catch(d){console.error("获取进度时出错:",d)}},_t=d=>{switch(d){case"success":return"success";case"failed":return"danger";case"skipped":return"info";default:return"info"}},re=d=>{switch(d){case"success":return"成功";case"failed":return"失败";case"skipped":return"跳过";default:return"未知"}},vt=d=>{if(!d||d===0)return"0 B";const n=1024,w=["B","KB","MB","GB","TB","PB"],m=Math.floor(Math.log(d)/Math.log(n));return`${(d/Math.pow(n,m)).toFixed(2)} ${w[m]}`},mt=(d,n=50)=>{if(!d||d.length<=n)return d;const w=Math.floor((n-3)/2);let m=d.substring(0,w),v=d.substring(d.length-w);const x=m.lastIndexOf("/"),te=v.indexOf("/");return x>0&&te>=0&&(m=m.substring(0,x),v=v.substring(te+1)),`${m}...${v}`};return xt(async()=>{await ot(),await Re(),await fe(),await rt(),_e()}),Ut(()=>{me()}),Dt(Q,()=>{j.value=1,_e(),Ie()}),(d,n)=>{const w=b("el-alert"),m=b("el-input"),v=b("el-button"),x=b("el-tag"),te=b("el-icon"),K=b("el-pagination"),R=b("el-table-column"),L=b("el-table"),P=b("el-divider"),Ue=b("el-tree"),Fe=b("el-checkbox"),Ee=b("el-checkbox-group"),he=b("el-card"),se=b("el-descriptions-item"),Qe=b("el-descriptions"),ht=b("el-progress"),Ze=Jt("loading");return p(),_("div",ws,[le.value?(p(),M(w,{key:0,title:le.value,type:"error","show-icon":"",closable:!1,center:"",style:{"margin-bottom":"15px"}},null,8,["title"])):C("",!0),r("div",bs,[s(m,{modelValue:Q.value,"onUpdate:modelValue":n[0]||(n[0]=h=>Q.value=h),placeholder:"搜索名称...",clearable:"",class:"search-input",style:{width:"300px","margin-right":"15px"}},null,8,["modelValue"]),s(v,{type:"primary",onClick:z,plain:"",style:{"margin-right":"15px"}},{default:a(()=>[...n[10]||(n[10]=[o(" 筛选 ",-1)])]),_:1}),He.value?(p(),_("div",ks,[s(x,{type:"info",size:"default",effect:"plain"},{default:a(()=>[o(f(nt.value),1)]),_:1}),s(v,{type:"danger",link:"",style:{padding:"0","margin-left":"8px"},onClick:ve},{default:a(()=>[...n[11]||(n[11]=[o("清除",-1)])]),_:1})])):C("",!0),s(v,{type:"warning",onClick:ct,plain:"",style:{"margin-right":"15px"}},{default:a(()=>[s(te,{style:{"margin-right":"5px"}},{default:a(()=>[s(Et(_s))]),_:1}),n[12]||(n[12]=o(" 设置优先级 ",-1))]),_:1}),s(v,{type:"success",onClick:X,plain:"",style:{"margin-right":"15px"},disabled:Y.value.length===0},{default:a(()=>[o(" 批量获取数据 ("+f(Y.value.length)+") ",1)]),_:1},8,["disabled"]),ne.value?(p(),M(v,{key:1,type:"info",onClick:Ye,plain:"",style:{"margin-right":"15px"}},{default:a(()=>[...n[13]||(n[13]=[o(" 查看进度 ",-1)])]),_:1})):C("",!0),ze.value.length>0?(p(),_("div",Ss,[s(K,{"current-page":j.value,"onUpdate:currentPage":n[1]||(n[1]=h=>j.value=h),"page-size":pe.value,"onUpdate:pageSize":n[2]||(n[2]=h=>pe.value=h),"page-sizes":[20,50,100],total:T.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:it,onCurrentChange:dt,background:""},null,8,["current-page","page-size","total"])])):C("",!0)]),r("div",xs,[st((p(),M(L,{data:ze.value,border:"",style:{width:"100%"},"empty-text":"暂无种子数据",height:"100%",onSelectionChange:ut},{default:a(()=>[s(R,{type:"selection",width:"55",align:"center","header-align":"center"}),s(R,{prop:"name",label:"种子名称","min-width":"400","show-overflow-tooltip":"","header-align":"center"}),s(R,{prop:"size",label:"大小",width:"110",align:"center","header-align":"center"},{default:a(h=>[o(f(vt(h.row.size)),1)]),_:1}),s(R,{prop:"save_path",label:"保存路径",width:"200","header-align":"center"},{default:a(h=>[r("div",{title:h.row.save_path,style:{width:"100%",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap"}},f(mt(h.row.save_path,30)),9,Ds)]),_:1}),s(R,{prop:"site_count",label:"站点数",width:"100",align:"center","header-align":"center"},{default:a(h=>[o(f(Object.keys(h.row.sites||{}).length),1)]),_:1}),s(R,{prop:"state",label:"状态",width:"120",align:"center","header-align":"center"}),s(R,{label:"已有源站点","min-width":"200","header-align":"center"},{default:a(h=>[(p(!0),_(Te,null,Ae(ee(h.row.sites),(Ce,Pe)=>(p(),M(x,{key:Pe,size:"small",type:"success",style:{margin:"2px"}},{default:a(()=>[o(f(Pe),1)]),_:2},1024))),128)),Object.keys(ee(h.row.sites)).length===0?(p(),_("span",Cs," 无可用源站点 ")):C("",!0)]),_:1})]),_:1},8,["data"])),[[Ze,de.value]])]),Z.value?(p(),_("div",{key:1,class:"filter-overlay",onClick:n[8]||(n[8]=Ct(h=>Z.value=!1,["self"]))},[s(he,{class:"filter-card"},{header:a(()=>[r("div",$s,[n[15]||(n[15]=r("span",null,"筛选选项",-1)),s(v,{type:"danger",circle:"",onClick:n[3]||(n[3]=h=>Z.value=!1),plain:""},{default:a(()=>[...n[14]||(n[14]=[o("X",-1)])]),_:1})])]),default:a(()=>[r("div",Ts,[s(P,{"content-position":"left"},{default:a(()=>[...n[16]||(n[16]=[o("保存路径",-1)])]),_:1}),r("div",zs,[s(Ue,{ref_key:"pathTreeRef",ref:ue,data:ce.value,"show-checkbox":"","node-key":"path","default-expand-all":"","expand-on-click-node":!1,"check-on-click-node":"","check-strictly":!0,props:{class:"path-tree-node"}},null,8,["data"])]),s(P,{"content-position":"left"},{default:a(()=>[...n[17]||(n[17]=[o("源站点",-1)])]),_:1}),s(Ee,{modelValue:J.value.sourceSiteAvailability,"onUpdate:modelValue":n[4]||(n[4]=h=>J.value.sourceSiteAvailability=h)},{default:a(()=>[s(Fe,{label:"存在源站点"},{default:a(()=>[...n[18]||(n[18]=[o("存在源站点",-1)])]),_:1}),s(Fe,{label:"无可用源站点"},{default:a(()=>[...n[19]||(n[19]=[o("无可用源站点",-1)])]),_:1})]),_:1},8,["modelValue"]),s(P,{"content-position":"left"},{default:a(()=>[...n[20]||(n[20]=[o("状态",-1)])]),_:1}),s(Ee,{modelValue:J.value.states,"onUpdate:modelValue":n[5]||(n[5]=h=>J.value.states=h)},{default:a(()=>[(p(!0),_(Te,null,Ae(G.value,h=>(p(),M(Fe,{key:h,label:h},{default:a(()=>[o(f(h),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"]),s(P,{"content-position":"left"},{default:a(()=>[...n[21]||(n[21]=[o("下载器",-1)])]),_:1}),s(Ee,{modelValue:J.value.downloaderIds,"onUpdate:modelValue":n[6]||(n[6]=h=>J.value.downloaderIds=h)},{default:a(()=>[(p(!0),_(Te,null,Ae(Xe.value,h=>(p(),M(Fe,{key:h.id,label:h.id},{default:a(()=>[o(f(h.name),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),r("div",Is,[s(v,{onClick:n[7]||(n[7]=h=>Z.value=!1)},{default:a(()=>[...n[22]||(n[22]=[o("取消",-1)])]),_:1}),s(v,{type:"primary",onClick:oe},{default:a(()=>[...n[23]||(n[23]=[o("确认",-1)])]),_:1})])]),_:1})])):C("",!0),ie.value?(p(),_("div",Rs,[s(he,{class:"batch-fetch-card",shadow:"always"},{header:a(()=>[r("div",Bs,[n[25]||(n[25]=r("span",null,"批量获取种子数据",-1)),s(v,{type:"danger",circle:"",onClick:N,plain:""},{default:a(()=>[...n[24]||(n[24]=[o("X",-1)])]),_:1})])]),default:a(()=>[r("div",Vs,[r("div",Fs,[r("h3",null,"已选择 "+f(Y.value.length)+" 个种子",1),n[26]||(n[26]=r("p",{style:{color:"#909399","font-size":"13px","margin-top":"5px"}}," 系统将按名称聚合，逐个从源站点获取种子数据并存储到数据库 ",-1))])]),r("div",Ps,[s(v,{onClick:N},{default:a(()=>[...n[27]||(n[27]=[o("取消",-1)])]),_:1}),s(v,{type:"primary",onClick:Ve},{default:a(()=>[...n[28]||(n[28]=[o(" 开始批量获取 ",-1)])]),_:1})])]),_:1})])):C("",!0),ke.value?(p(),_("div",Ms,[s(he,{class:"priority-settings-card",shadow:"always"},{header:a(()=>[r("div",Ns,[n[30]||(n[30]=r("span",null,"源站点优先级设置",-1)),s(v,{type:"danger",circle:"",onClick:Le,plain:""},{default:a(()=>[...n[29]||(n[29]=[o("X",-1)])]),_:1})])]),default:a(()=>[r("div",As,[s(w,{type:"info","show-icon":"",closable:!1,style:{"margin-bottom":"20px"}},{title:a(()=>[...n[31]||(n[31]=[o(" 设置批量获取种子数据时的源站点优先级顺序，系统将按顺序查找第一个可用的源站点",-1),r("br",null,null,-1),o(" 如果第一个源站点无法获取会按顺序自动切换源站点 ",-1)])]),_:1}),r("div",Ls,[n[32]||(n[32]=r("p",{style:{color:"#606266","font-size":"14px","margin-bottom":"10px","font-weight":"600"}}," 源站点优先级顺序： ",-1)),st((p(),_("div",Os,[(p(!0),_(Te,null,Ae(O.value,(h,Ce)=>(p(),M(x,{key:h.name,type:Ke(Ce),size:"large",draggable:"true",onDragstart:Pe=>ft(Ce),onDragover:n[9]||(n[9]=Ct(()=>{},["prevent"])),onDrop:Pe=>A(Ce),style:{margin:"5px",cursor:"move","user-select":"none"}},{default:a(()=>[o(f(Ce+1)+". "+f(h.name),1)]),_:2},1032,["type","onDragstart","onDrop"]))),128)),O.value.length===0?(p(),_("span",Us," 未配置源站点优先级 ")):C("",!0)])),[[Ze,Se.value]]),n[33]||(n[33]=r("div",{class:"priority-tip",style:{"margin-top":"10px","font-size":"12px",color:"#909399"}}," 拖拽调整优先级顺序，系统将按此顺序查找可用的源站点。 ",-1))])]),r("div",Es,[s(v,{onClick:Le},{default:a(()=>[...n[34]||(n[34]=[o("取消",-1)])]),_:1}),s(v,{type:"primary",onClick:Be,loading:q.value},{default:a(()=>[...n[35]||(n[35]=[o(" 保存设置 ",-1)])]),_:1},8,["loading"])])]),_:1})])):C("",!0),B.value?(p(),_("div",Js,[s(he,{class:"progress-card",shadow:"always"},{header:a(()=>[r("div",qs,[r("span",null,"批量获取进度 "+f(k.value.isRunning?"(进行中...)":"(已完成)"),1),r("div",js,[k.value.isRunning?(p(),M(v,{key:0,type:"warning",size:"small",onClick:me},{default:a(()=>[...n[36]||(n[36]=[o(" 停止自动刷新 ",-1)])]),_:1})):(p(),M(v,{key:1,type:"primary",size:"small",onClick:Oe},{default:a(()=>[...n[37]||(n[37]=[o(" 刷新 ",-1)])]),_:1})),s(v,{type:"danger",circle:"",onClick:Ge,plain:""},{default:a(()=>[...n[38]||(n[38]=[o("X",-1)])]),_:1})])])]),default:a(()=>[r("div",Xs,[r("div",Hs,[s(Qe,{column:2,border:""},{default:a(()=>[s(se,{label:"总数"},{default:a(()=>[o(f(k.value.total),1)]),_:1}),s(se,{label:"已处理"},{default:a(()=>[o(f(k.value.processed),1)]),_:1}),s(se,{label:"成功"},{default:a(()=>[s(x,{type:"success",size:"small"},{default:a(()=>[o(f(k.value.success),1)]),_:1})]),_:1}),s(se,{label:"失败"},{default:a(()=>[s(x,{type:"danger",size:"small"},{default:a(()=>[o(f(k.value.failed),1)]),_:1})]),_:1}),s(se,{label:"跳过"},{default:a(()=>[s(x,{type:"info",size:"small"},{default:a(()=>[o(f(k.value.skipped),1)]),_:1})]),_:1}),s(se,{label:"状态"},{default:a(()=>[s(x,{type:k.value.isRunning?"warning":"success",size:"small"},{default:a(()=>[o(f(k.value.isRunning?"进行中":"已完成"),1)]),_:1},8,["type"])]),_:1})]),_:1}),k.value.bdinfo_stats?(p(),_("div",Ws,[n[39]||(n[39]=r("h4",{style:{margin:"15px 0 10px 0","font-size":"14px",color:"#606266"}},"BDInfo 处理状态",-1)),s(Qe,{column:3,border:"",size:"small"},{default:a(()=>[s(se,{label:"处理中"},{default:a(()=>[s(x,{type:"warning",size:"small"},{default:a(()=>[o(f(k.value.bdinfo_stats.processing),1)]),_:1})]),_:1}),s(se,{label:"已完成"},{default:a(()=>[s(x,{type:"success",size:"small"},{default:a(()=>[o(f(k.value.bdinfo_stats.completed),1)]),_:1})]),_:1}),s(se,{label:"失败"},{default:a(()=>[s(x,{type:"danger",size:"small"},{default:a(()=>[o(f(k.value.bdinfo_stats.failed),1)]),_:1})]),_:1})]),_:1})])):C("",!0),s(ht,{percentage:We.value,status:ge.value,style:{"margin-top":"15px"}},null,8,["percentage","status"])]),s(P,{"content-position":"left"},{default:a(()=>[...n[40]||(n[40]=[o("处理详情",-1)])]),_:1}),r("div",Ks,[s(L,{data:k.value.results,style:{width:"100%"},size:"small",stripe:"","max-height":"400"},{default:a(()=>[s(R,{prop:"name",label:"种子名称","min-width":"300","show-overflow-tooltip":""}),s(R,{prop:"status",label:"状态",width:"100",align:"center"},{default:a(h=>[s(x,{type:_t(h.row.status),size:"small"},{default:a(()=>[o(f(re(h.row.status)),1)]),_:2},1032,["type"])]),_:1}),s(R,{prop:"source_site",label:"源站点",width:"120",align:"center"}),s(R,{prop:"reason",label:"失败原因","min-width":"200","show-overflow-tooltip":""})]),_:1},8,["data"])])]),r("div",Ys,[s(v,{onClick:Ge},{default:a(()=>[...n[41]||(n[41]=[o("关闭",-1)])]),_:1})])]),_:1})])):C("",!0)])}}}),Zs=jt(Qs,[["__scopeId","data-v-f4a87c84"]]),ea={class:"cross-seed-data-view"},ta={class:"search-and-controls glass-table"},sa={key:0,class:"current-filters",style:{"margin-right":"15px",display:"flex","align-items":"center"}},aa={key:1,class:"pagination-controls"},la={class:"filter-card-header"},na={class:"filter-card-body"},oa={class:"path-tree-container"},ra={class:"target-sites-container"},ia={class:"selected-site-display"},da={key:0,class:"selected-site-info"},ua={key:1,class:"selected-site-info"},ca={class:"target-sites-radio-container"},pa={class:"filter-card-footer"},fa={class:"table-container"},ga={class:"mapped-cell"},_a={class:"title-cell"},va=["title"],ma=["title"],ha={class:"tags-cell"},ya={class:"mapped-cell datetime-cell"},wa={key:2,class:"modal-overlay"},ba={class:"modal-header"},ka={class:"cross-seed-content"},Sa={key:3,class:"modal-overlay"},xa={class:"modal-header"},Da={class:"batch-cross-seed-content"},Ca={class:"target-site-selection-body"},$a={class:"batch-info"},Ta={class:"batch-cross-seed-footer"},za={key:4,class:"modal-overlay"},Ia={class:"record-view-content"},Ra={class:"record-tabs-header"},Ba={class:"record-tabs-nav"},Va={class:"record-close-btn"},Fa={class:"tab-header"},Pa={class:"tab-controls"},Ma={key:0,class:"records-table-container"},Na={key:0},Aa={key:1},La={key:0,class:"progress-cell"},Oa={class:"progress-text"},Ua={key:1},Ea={key:0},Ja={key:1},qa={key:2},ja={key:1},Xa={class:"mapped-cell datetime-cell"},Ha={key:1,class:"no-records"},Wa={class:"tab-header"},Ka={class:"bdinfo-filter-controls"},Ya={class:"tab-controls"},Ga={key:0,class:"bdinfo-records-table-container"},Qa={class:"mapped-cell"},Za={key:0},el={key:1},tl={key:0},sl={key:1},al={key:0},ll={key:1},nl={key:0,style:{"text-align":"center"}},ol={style:{"font-size":"12px","margin-top":"4px",color:"#606266"}},rl={key:1,style:{"text-align":"center"}},il={key:2},dl={key:1,class:"no-records"},ul={key:5,class:"modal-overlay"},cl={class:"modal-header"},pl={class:"bdinfo-detail-content"},fl={key:0,class:"task-id-cell"},gl={key:1},_l={key:0,class:"error-section"},vl={key:1,class:"mediainfo-section"},ml={style:{margin:"15px 0 10px 0",color:"#606266"}},hl={style:{"margin-top":"10px","text-align":"right"}},yl={class:"bdinfo-detail-footer"},wl={key:6,class:"modal-overlay"},bl={class:"modal-header"},kl={class:"batch-fetch-main-content"},Sl=1e3,xl=5e3,Dl=Ot({__name:"CrossSeedDataView",emits:["ready"],setup(Xt,{emit:at}){const lt=at;xt(()=>{lt("ready",A)});const ze=t=>{const e=(t||"").trim().toLowerCase();return e?e==="category.animation"?!0:e.includes("animation")||e.includes("anime")||e.includes("动漫")||e.includes("动画"):!1},de=g({type:{},medium:{},video_codec:{},audio_codec:{},resolution:{},source:{},team:{},tags:{},site_name:{}}),le=g([]),Y=g(!0),ie=g(null),B=g([]),ke=g(!1),Se=g(!1),q=g(!1),O=g(!1),U=g([]),ue=g(!1),ce=g(new Map),E=g("cross-seed"),G=g([]),Xe=g(!1),j=g(""),pe=g(!1),T=g(null),Q=g(new Set),Z=g(null),F=g(0),J=g(null),ne=g(!1),k=g(null),xe=g([]),nt=g([]),He=g(window.innerHeight-80),W=g(1),fe=g(20),We=g(0),ge=g(""),De=g(""),_e=async t=>{De.value=t,W.value=1;try{await $.post("/api/config/cross_seed_review_filter",{review_filter:t})}catch(e){console.error("保存检查状态筛选失败:",e)}A()},ot=H(()=>{const t=z.value,e=[];return t.paths&&t.paths.length>0&&e.push(`路径: ${t.paths.length}`),t.isDeleted==="0"?e.push("未删除"):t.isDeleted==="1"&&e.push("已删除"),t.excludeTargetSites&&t.excludeTargetSites.trim()!==""&&e.push(`不存在于: ${t.excludeTargetSites}`),e.join(", ")}),rt=H(()=>B.value.length>0&&z.value.excludeTargetSites&&z.value.excludeTargetSites.trim()!==""),it=H(()=>{const t=B.value.length,e=z.value.excludeTargetSites;return!e||e.trim()===""?`批量转种 (${t}) - 请先在筛选中选择目标站点`:`批量转种到 ${e} (${t})`}),dt=H(()=>{const t=z.value;return t.paths&&t.paths.length>0||t.isDeleted!==""||t.excludeTargetSites&&t.excludeTargetSites.trim()!==""}),ve=g(!1),z=g({paths:[],isDeleted:"",excludeTargetSites:""}),oe=g({...z.value}),Ie=g([]),Re=H({get:()=>oe.value.excludeTargetSites||"",set:t=>{oe.value.excludeTargetSites=t}}),ut=()=>{oe.value.excludeTargetSites=""},ee=(t,e)=>{if(!e)return"";const i=de.value[t];return i&&i[e]||e},X=t=>t?/^[^.]+[.][^.]+$/.test(t):!0,N=(t,e)=>{if(!e)return!0;const i=de.value[t];return i?!!i[e]:!1},ct=t=>{let e=[];if(typeof t=="string")try{e=JSON.parse(t)}catch{e=t.split(",").map(i=>i.trim()).filter(i=>i)}else Array.isArray(t)&&(e=t);return e.length===0?[]:e.map(i=>de.value.tags[i]||i)},Le=(t,e)=>{let i=[];if(typeof t=="string")try{i=JSON.parse(t)}catch{i=t.split(",").map(c=>c.trim()).filter(c=>c)}else Array.isArray(t)&&(i=t);if(i.length===0||e>=i.length)return"info";const u=i[e];return u==="禁转"||u==="tag.禁转"||u==="限转"||u==="tag.限转"||u==="分集"||u==="tag.分集"||!X(u)||!N("tags",u)?"danger":"info"},pt=(t,e)=>{let i=[];if(typeof t=="string")try{i=JSON.parse(t)}catch{i=t.split(",").map(c=>c.trim()).filter(c=>c)}else Array.isArray(t)&&(i=t);if(i.length===0||e>=i.length)return"";const u=i[e];return u==="禁转"||u==="tag.禁转"||u==="限转"||u==="tag.限转"||u==="分集"||u==="tag.分集"?"restricted-tag":!X(u)||!N("tags",u)?"invalid-tag":""},Be=t=>{if(!t)return"";try{const e=new Date(t);if(isNaN(e.getTime()))return t;const i=e.getFullYear(),u=String(e.getMonth()+1).padStart(2,"0"),c=String(e.getDate()).padStart(2,"0"),D=String(e.getHours()).padStart(2,"0"),I=String(e.getMinutes()).padStart(2,"0"),V=String(e.getSeconds()).padStart(2,"0");return`${i}-${u}-${c}
${D}:${I}:${V}`}catch{return t}},Ke=t=>{const e=["type","medium","video_codec","audio_codec","resolution","team","source"];for(const u of e){const c=t[u];if(c&&(!X(c)||!N(u,c)))return!0}let i=[];if(typeof t.tags=="string")try{i=JSON.parse(t.tags)}catch{i=t.tags.split(",").map(u=>u.trim()).filter(u=>u)}else Array.isArray(t.tags)&&(i=t.tags);for(const u of i)if(!X(u)||!N("tags",u))return!0;return!!t.unrecognized},ft=t=>{const e=[],i=new Map;return t.sort().forEach(u=>{const c=u.replace(/^\/|\/$/g,"").split("/");let D="",I=e;c.forEach((V,$e)=>{if(D=$e===0?`/${V}`:`${D}/${V}`,!i.has(D)){const et={path:$e===c.length-1?u:D,label:V,children:[]};i.set(D,et),I.push(et)}I=i.get(D).children})}),i.forEach(u=>{u.children&&u.children.length===0&&delete u.children}),e},A=async()=>{Y.value=!0,ie.value=null;try{const t=new URLSearchParams({page:W.value.toString(),page_size:fe.value.toString(),search:ge.value,path_filters:JSON.stringify(z.value.paths||[]),is_deleted:z.value.isDeleted,exclude_target_sites:z.value.excludeTargetSites,review_status:De.value});z.value.excludeTargetSites&&console.log("发送目标站点排除参数:",z.value.excludeTargetSites);const i=(await $.get(`/api/cross-seed-data?${t.toString()}`)).data;if(i.success){if(le.value=i.data,We.value=i.total,i.reverse_mappings&&(de.value=i.reverse_mappings),i.unique_paths&&(nt.value=i.unique_paths,xe.value=ft(i.unique_paths)),i.target_sites){const u=(i.target_sites||[]).filter(c=>String(c||"").trim().toLowerCase()!=="ilolicon"?!0:i.data.some(I=>ze(I.type)));Ie.value=u,z.value.excludeTargetSites&&!u.includes(z.value.excludeTargetSites)&&(z.value.excludeTargetSites="")}}else ie.value=i.error||"获取数据失败",y.error(i.error||"获取数据失败")}catch(t){ie.value=t.message||"网络错误",y.error(t.message||"网络错误")}finally{Y.value=!1}},Ve=async()=>{try{const t={page_size:fe.value,search_query:ge.value,active_filters:z.value};await $.post("/api/ui_settings/cross_seed",t)}catch(t){console.error("无法保存UI设置:",t.message)}},Ye=async()=>{try{const e=(await $.get("/api/ui_settings/cross_seed")).data;fe.value=e.page_size??20,ge.value=e.search_query??"",e.active_filters&&Object.assign(z.value,e.active_filters)}catch(t){console.error("加载UI设置时出错:",t)}},Ge=t=>{fe.value=t,W.value=1,A(),Ve()},gt=t=>{W.value=t,A()},me=()=>{z.value={paths:[],isDeleted:"",excludeTargetSites:""},W.value=1,A(),Ve()},Oe=()=>{oe.value={...z.value},ve.value=!0,qt(()=>{k.value&&z.value.paths.length>0&&k.value.setCheckedKeys(z.value.paths,!1)})},_t=()=>{if(k.value){const t=k.value.getCheckedKeys(!1);oe.value.paths=t}z.value={...oe.value},ve.value=!1,W.value=1,A(),Ve()},re=hs();Dt(ge,()=>{W.value=1,A(),Ve()});const vt=H(()=>!!re.taskId),mt=H(()=>re.workingParams?.title||""),d=async t=>{try{re.reset();const i=(await $.get(`/api/migrate/get_db_seed_info?torrent_id=${t.torrent_id}&site_name=${t.site_name}`)).data;if(i.success){const u={...i.data,name:i.data.name||i.data.title,save_path:i.data.save_path||"",size:0,size_formatted:"0 B",progress:100,state:"completed",total_uploaded:0,total_uploaded_formatted:"0 B",downloaderId:i.data.downloader_id||null,sites:{[i.data.site_name]:{torrentId:i.data.torrent_id,comment:`id=${i.data.torrent_id}`}}};re.setParams(u);const c={name:i.data.site_name,site:i.data.site_name.toLowerCase(),torrentId:i.data.torrent_id};re.setSourceInfo(c),re.setTaskId(`cross_seed_${t.id}_${Date.now()}`)}else y.error(i.error||"获取种子参数失败")}catch(e){y.error(e.message||"网络错误")}},n=async t=>{try{await Lt.confirm(`确定要永久删除种子数据 "${t.title}" 吗？此操作无法恢复！`,"确认永久删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});const e={torrent_id:t.torrent_id,site_name:t.site_name},u=(await $.post("/api/cross-seed-data/delete",e)).data;u.success?(y.success(u.message||"删除成功"),A()):y.error(u.error||"删除失败")}catch(e){e!=="cancel"&&y.error(e.message||"网络错误")}},w=()=>{re.reset()},m=()=>{y.success("转种操作已完成！"),re.reset(),A()},v=()=>{He.value=window.innerHeight-80};xt(async()=>{await Ye(),await x(),A(),window.addEventListener("resize",v)});const x=async()=>{try{const e=(await $.get("/api/config/cross_seed_review_filter")).data;e.success&&(De.value=e.data||"")}catch(t){console.error("加载检查状态筛选配置失败:",t)}},te=({row:t})=>t.is_deleted||R(t.tags)||t.unrecognized?"deleted-row":t.is_reviewed?P(t)?"":"selected-row-disabled":"unreviewed-row",K=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch{return t.split(",").map(e=>e.trim()).filter(e=>e)}return Array.isArray(t)?t:[]},R=t=>K(t).some(i=>i==="禁转"||i==="tag.禁转"||i==="限转"||i==="tag.限转"||i==="分集"||i==="tag.分集"),L=t=>{const e=[],i=K(t.tags);t.is_deleted&&e.push("已删除做种文件");const u=[];return i.some(c=>c==="禁转"||c==="tag.禁转")&&u.push("禁转"),i.some(c=>c==="限转"||c==="tag.限转")&&u.push("限转"),i.some(c=>c==="分集"||c==="tag.分集")&&u.push("分集"),u.length>0&&e.push(u.join("/")),e.join(`
`)},P=t=>q.value?!0:R(t.tags)?!1:z.value.isDeleted==="1"?!Ke(t):!(t.is_deleted||Ke(t)||!t.is_reviewed),Ue=t=>{B.value=t,q.value},Fe=()=>{ke.value=!0},Ee=async()=>{const t=z.value.excludeTargetSites;if(!t||t.trim()===""){y.warning("请先在筛选中选择目标站点");return}try{he();const e={target_site_name:t,seeds:B.value.map(c=>({hash:c.hash,torrent_id:c.torrent_id,site_name:c.site_name,nickname:c.nickname,downloader_id:c.downloader_id||""}))};console.log("批量转种数据:",e),O.value=!0,yt();const u=(await $.post("/api/go-api/batch-enhance",e)).data;u.success?y.success(`批量转种请求已发送，成功 ${u.data.seeds_processed} 个，失败 ${u.data.seeds_failed} 个`):(ye(),y.error(u.error||"批量转种失败"))}catch(e){ye(),y.error(e.message||"网络错误")}},he=()=>{ke.value=!1},se=()=>q.value?B.value.length===0?"退出删除模式":`删除选中项 (${B.value.length})`:"批量删除模式",Qe=async()=>{q.value?(q.value=!1,B.value=[]):(q.value=!0,B.value=[])},ht=async()=>{if(B.value.length===0){y.warning("请先选择要删除的行");return}try{await Lt.confirm(`确定要删除选中的 ${B.value.length} 条种子数据吗？此操作无法恢复！`,"确认批量删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});const t={items:B.value.map(u=>({torrent_id:u.torrent_id,site_name:u.site_name}))},i=(await $.post("/api/cross-seed-data/delete",t)).data;i.success?(y.success(i.message||`成功删除 ${i.deleted_count} 条数据`),B.value=[],q.value=!1,A()):y.error(i.error||"批量删除失败")}catch(t){t!=="cancel"&&y.error(t.message||"网络错误")}},Ze=()=>{Se.value=!0},h=()=>{Se.value=!1},Ce=()=>{y.success("批量获取种子数据已完成，正在刷新列表..."),A()},Pe=t=>t?t.includes("成功")||t.includes("失败"):!1;H(()=>{if(U.value.length===0)return!1;const t=U.value[0];return!Pe(t.downloader_add_result)}),H(()=>G.value.some(t=>t.mediainfo_status==="processing_bdinfo"||t.mediainfo_status==="processing"));const yt=()=>{ye(),Je(),Z.value=setInterval(async()=>{O.value&&E.value==="cross-seed"?await Je():ye()},Sl)},ye=()=>{Z.value&&(clearInterval(Z.value),Z.value=null),F.value=0},Ht=()=>{O.value=!0,E.value==="cross-seed"?(Je(),yt()):E.value==="bdinfo"&&(qe(),wt())},Wt=()=>{O.value=!1,ye(),je(),A()},Je=async()=>{try{bt();const e=(await $.get("/api/go-api/records")).data;U.value=e.records||[]}catch(t){console.error("获取记录时出错:",t),y.error("获取记录失败: "+(t.message||"网络错误"))}},Kt=async()=>{try{const t=await $.delete("/api/go-api/records");U.value=[],bt(),y.success("记录已清空")}catch{U.value=[],bt(),y.success("本地记录已清空")}},Yt=t=>{switch(t){case"success":return"success";case"failed":return"danger";case"filtered":return"warning";case"processing":return"primary";case"pending":return"info";default:return"info"}},Gt=t=>{switch(t){case"success":return"成功";case"failed":return"失败";case"filtered":return"已过滤";case"processing":return"获取中";case"pending":return"等待中";default:return"未知"}},Qt=async t=>{j.value=t,await qe()},qe=async()=>{try{const t=new URLSearchParams({status_filter:j.value}),e=new Map;for(const c of G.value)c.mediainfo_status==="processing_bdinfo"&&c.progress_info&&e.set(c.seed_id,c.progress_info);const u=(await $.get(`/api/migrate/bdinfo_records?${t.toString()}`)).data;if(u.success){const c=u.data||[];for(const I of c)I.mediainfo_status==="processing_bdinfo"&&e.has(I.seed_id)&&(I.progress_info=e.get(I.seed_id));G.value=c;const D=[];for(const I of G.value)if(I.mediainfo_status==="processing_bdinfo"&&I.bdinfo_task_id){const V=(async()=>{try{const we=(await $.get(`/api/migrate/bdinfo_status/${I.seed_id}`)).data;we.task_status&&we.progress_info&&(I.progress_info=we.progress_info)}catch($e){console.error(`获取BDInfo进度失败: ${I.seed_id}`,$e)}})();D.push(V)}await Promise.all(D)}else y.error(u.message||"获取BDInfo记录失败")}catch(t){console.error("获取BDInfo记录时出错:",t),y.error(t.message||"网络错误")}},wt=()=>{je(),J.value=setInterval(async()=>{O.value&&E.value==="bdinfo"?await qe():je()},xl)},je=()=>{J.value&&(clearInterval(J.value),J.value=null)},$t=t=>{switch(t){case"queued":return"info";case"processing_bdinfo":case"processing":return"warning";case"completed":return"success";case"failed":return"danger";default:return"info"}},Tt=t=>{switch(t){case"queued":return"等待中";case"processing_bdinfo":case"processing":return"获取中";case"completed":return"已完成";case"failed":return"失败";default:return"未知"}},zt=t=>{if(!t.bdinfo_started_at)return"-";const e=new Date(t.bdinfo_started_at),u=(t.bdinfo_completed_at?new Date(t.bdinfo_completed_at):new Date).getTime()-e.getTime();return u<0?"-":u<6e4?`${Math.floor(u/1e3)}秒`:u<36e5?`${Math.floor(u/6e4)}分钟`:`${Math.floor(u/36e5)}小时`},It=async t=>{try{await navigator.clipboard.writeText(t),y.success("已复制到剪贴板")}catch{y.error("复制失败")}},Zt=t=>{T.value=t||null,pe.value=!0},Rt=()=>{pe.value=!1,T.value=null},es=t=>{if(!t.bdinfo_started_at)return!0;const e=new Date(t.bdinfo_started_at),i=new Date;if((i.getTime()-e.getTime())/(1e3*60)>30){if(!t.progress_info||t.progress_info.progress_percent===0)return!0;if(t.progress_info.last_progress_update){const c=new Date(t.progress_info.last_progress_update),D=(i.getTime()-c.getTime())/(1e3*60);return t.progress_info.progress_percent<10?D>15:t.progress_info.progress_percent<50?D>10:D>5}}return!1},ts=t=>t.mediainfo_status==="failed"?!0:t.mediainfo_status==="processing_bdinfo"?es(t):!1,ss=async t=>{try{Q.value.add(t.seed_id);try{await $.post("/api/migrate/cleanup_bdinfo_process",{seed_id:t.seed_id})}catch(u){console.warn("清理进程失败:",u)}const i=(await $.post("/api/migrate/restart_bdinfo",{seed_id:t.seed_id})).data;i.success?(y.success("BDInfo重新获取任务已启动"),await qe(),wt()):y.error(i.message||"启动BDInfo重新获取失败")}catch(e){y.error(e.message||"网络错误")}finally{Q.value.delete(t.seed_id)}},Bt=t=>t?(ce.value.has(t)||ce.value.set(t,ce.value.size+1),ce.value.get(t)):"-",as=t=>{if(typeof t!="number")return"info";const e=["success","primary","warning","info"];return e[(t-1)%e.length]},bt=()=>{ce.value.clear()},ls=t=>t.startsWith("成功")?"success":t.startsWith("失败")?"danger":"info",ns=t=>t.startsWith("成功")?"#67c23a":t.startsWith("失败")?"#f56c6c":"#909399",Vt=t=>t.startsWith("成功:")||t.startsWith("失败:")?t.substring(3):t,os=t=>{if(!t)return t;const e=t.indexOf("&uploaded");return e!==-1?t.substring(0,e):t},rs=t=>{try{const e=new Date(t);if(isNaN(e.getTime()))return t;const i=e.getFullYear(),u=String(e.getMonth()+1).padStart(2,"0"),c=String(e.getDate()).padStart(2,"0"),D=String(e.getHours()).padStart(2,"0"),I=String(e.getMinutes()).padStart(2,"0"),V=String(e.getSeconds()).padStart(2,"0");return`${i}-${u}-${c}
${D}:${I}:${V}`}catch{return t}},Ft=t=>{if(!t)return 0;const e=t.match(/(\d+)\/(\d+)/);if(e){const i=parseInt(e[1]),u=parseInt(e[2]);if(u>0)return Math.round(i/u*100)}return 0},is=t=>t<30?"#e6a23c":t<70?"#409eff":"#67c23a",ds=async()=>{ne.value=!0;try{const e=(await $.post("/api/go-api/batch-enhance/stop")).data;e.success?(y.success("批量转种已停止"),ye(),await Je()):y.error(e.error||"停止批量转种失败")}catch(t){y.error(t.message||"停止批量转种失败")}finally{ne.value=!1}};return Dt(E,(t,e)=>{t==="cross-seed"?(Je(),yt()):t==="bdinfo"&&(qe(),wt()),e==="cross-seed"?ye():e==="bdinfo"&&je()}),Ut(()=>{window.removeEventListener("resize",v),ye(),je()}),(t,e)=>{const i=b("el-alert"),u=b("el-input"),c=b("el-button"),D=b("el-radio-button"),I=b("el-radio-group"),V=b("el-tag"),$e=b("el-pagination"),we=b("el-divider"),et=b("el-tree"),tt=b("el-radio"),Me=b("el-card"),S=b("el-table-column"),kt=b("el-table"),St=b("el-progress"),us=b("el-link"),cs=b("el-tooltip"),Pt=b("el-empty"),Mt=b("el-tab-pane"),ps=b("el-tabs"),be=b("el-descriptions-item"),fs=b("el-icon"),gs=b("el-descriptions"),Nt=Jt("loading");return p(),_("div",ea,[ie.value?(p(),M(i,{key:0,title:ie.value,type:"error","show-icon":"",closable:!1,style:{margin:"0","border-radius":"0"}},null,8,["title"])):C("",!0),r("div",ta,[s(u,{modelValue:ge.value,"onUpdate:modelValue":e[0]||(e[0]=l=>ge.value=l),placeholder:"搜索标题或种子ID...",clearable:"",class:"search-input",style:{width:"300px","margin-right":"15px"}},null,8,["modelValue"]),s(c,{type:"success",onClick:Fe,plain:"",style:{"margin-right":"15px"},disabled:!rt.value||q.value},{default:a(()=>[o(f(it.value),1)]),_:1},8,["disabled"]),s(c,{type:"info",onClick:Ht,plain:"",style:{"margin-right":"15px"}},{default:a(()=>[...e[16]||(e[16]=[o(" 日志 ",-1)])]),_:1}),s(c,{type:"warning",onClick:Ze,plain:"",style:{"margin-right":"15px"}},{default:a(()=>[...e[17]||(e[17]=[o(" 获取数据 ",-1)])]),_:1}),s(c,{type:"danger",onClick:e[1]||(e[1]=l=>q.value&&B.value.length>0?ht():Qe()),plain:"",style:{"margin-right":"15px"}},{default:a(()=>[o(f(se()),1)]),_:1}),s(c,{type:"primary",onClick:Oe,plain:"",style:{"margin-right":"15px"}},{default:a(()=>[...e[18]||(e[18]=[o(" 筛选 ",-1)])]),_:1}),s(I,{modelValue:De.value,"onUpdate:modelValue":e[2]||(e[2]=l=>De.value=l),onChange:_e,style:{"margin-right":"15px"}},{default:a(()=>[s(D,{label:""},{default:a(()=>[...e[19]||(e[19]=[o("全部",-1)])]),_:1}),s(D,{label:"reviewed"},{default:a(()=>[...e[20]||(e[20]=[o("已检查",-1)])]),_:1}),s(D,{label:"unreviewed"},{default:a(()=>[...e[21]||(e[21]=[o("待检查",-1)])]),_:1}),s(D,{label:"error"},{default:a(()=>[...e[22]||(e[22]=[o("错误",-1)])]),_:1})]),_:1},8,["modelValue"]),dt.value?(p(),_("div",sa,[s(V,{type:"info",size:"default",effect:"plain"},{default:a(()=>[o(f(ot.value),1)]),_:1}),s(c,{type:"danger",link:"",style:{padding:"0","margin-left":"8px"},onClick:me},{default:a(()=>[...e[23]||(e[23]=[o("清除",-1)])]),_:1})])):C("",!0),le.value.length>0?(p(),_("div",aa,[s($e,{"current-page":W.value,"onUpdate:currentPage":e[3]||(e[3]=l=>W.value=l),"page-size":fe.value,"onUpdate:pageSize":e[4]||(e[4]=l=>fe.value=l),"page-sizes":[20,50,100],total:We.value,layout:"total, sizes, prev, pager, next",onSizeChange:Ge,onCurrentChange:gt,background:""},null,8,["current-page","page-size","total"])])):C("",!0)]),ve.value?(p(),_("div",{key:1,class:"filter-overlay",onClick:e[9]||(e[9]=Ct(l=>ve.value=!1,["self"]))},[s(Me,{class:"filter-card"},{header:a(()=>[r("div",la,[e[25]||(e[25]=r("span",null,"筛选选项",-1)),s(c,{type:"danger",circle:"",onClick:e[5]||(e[5]=l=>ve.value=!1),plain:""},{default:a(()=>[...e[24]||(e[24]=[o("X",-1)])]),_:1})])]),default:a(()=>[r("div",na,[s(we,{"content-position":"left"},{default:a(()=>[...e[26]||(e[26]=[o("保存路径",-1)])]),_:1}),r("div",oa,[s(et,{ref_key:"pathTreeRef",ref:k,data:xe.value,"show-checkbox":"","node-key":"path","default-expand-all":"","expand-on-click-node":!1,"check-on-click-node":"","check-strictly":!0,props:{class:"path-tree-node"}},null,8,["data"])]),s(we,{"content-position":"left"},{default:a(()=>[...e[27]||(e[27]=[o("删除状态",-1)])]),_:1}),s(I,{modelValue:oe.value.isDeleted,"onUpdate:modelValue":e[6]||(e[6]=l=>oe.value.isDeleted=l),style:{width:"100%"}},{default:a(()=>[s(tt,{label:""},{default:a(()=>[...e[28]||(e[28]=[o("全部",-1)])]),_:1}),s(tt,{label:"0"},{default:a(()=>[...e[29]||(e[29]=[o("未删除",-1)])]),_:1}),s(tt,{label:"1"},{default:a(()=>[...e[30]||(e[30]=[o("已删除",-1)])]),_:1})]),_:1},8,["modelValue"]),s(we,{"content-position":"left"},{default:a(()=>[...e[31]||(e[31]=[o("不存在种子筛选",-1)])]),_:1}),r("div",ra,[r("div",ia,[Re.value?(p(),_("div",da,[s(V,{type:"info",size:"default",effect:"plain"},{default:a(()=>[o("已选择: "+f(Re.value),1)]),_:1}),s(c,{type:"danger",link:"",style:{padding:"0","margin-left":"8px"},onClick:ut},{default:a(()=>[...e[32]||(e[32]=[o("清除",-1)])]),_:1})])):(p(),_("div",ua,[s(V,{type:"info",size:"default",effect:"plain"},{default:a(()=>[...e[33]||(e[33]=[o("未选择",-1)])]),_:1})]))]),r("div",ca,[s(I,{modelValue:Re.value,"onUpdate:modelValue":e[7]||(e[7]=l=>Re.value=l),class:"target-sites-radio-group"},{default:a(()=>[(p(!0),_(Te,null,Ae(Ie.value,l=>(p(),M(tt,{key:l,label:l,class:"target-site-radio"},{default:a(()=>[o(f(l),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])])])]),r("div",pa,[s(c,{onClick:e[8]||(e[8]=l=>ve.value=!1)},{default:a(()=>[...e[34]||(e[34]=[o("取消",-1)])]),_:1}),s(c,{type:"primary",onClick:_t},{default:a(()=>[...e[35]||(e[35]=[o("确认",-1)])]),_:1})])]),_:1})])):C("",!0),r("div",fa,[st((p(),M(kt,{data:le.value,border:"",style:{width:"100%"},"empty-text":"暂无转种数据","max-height":He.value,height:"100%","row-class-name":te,onSelectionChange:Ue,class:"glass-table"},{default:a(()=>[s(S,{type:"selection",width:"55",align:"center",selectable:P}),s(S,{prop:"torrent_id",label:"种子ID",align:"center",width:"80","show-overflow-tooltip":""}),s(S,{prop:"nickname",label:"站点名称",width:"100",align:"center"},{default:a(l=>[r("div",ga,f(l.row.nickname),1)]),_:1}),s(S,{prop:"title",label:"标题",align:"center"},{default:a(l=>[r("div",_a,[r("div",{class:"subtitle-line",title:l.row.subtitle},f(l.row.subtitle||""),9,va),r("div",{class:"main-title-line",title:l.row.title},f(l.row.title||""),9,ma)])]),_:1}),s(S,{prop:"type",label:"类型",width:"100",align:"center"},{default:a(l=>[r("div",{class:ae(["mapped-cell",{"invalid-value":!X(l.row.type)||!N("type",l.row.type)}])},f(ee("type",l.row.type)),3)]),_:1}),s(S,{prop:"medium",label:"媒介",width:"100",align:"center"},{default:a(l=>[r("div",{class:ae(["mapped-cell",{"invalid-value":!X(l.row.medium)||!N("medium",l.row.medium)}])},f(ee("medium",l.row.medium)),3)]),_:1}),s(S,{prop:"video_codec",label:"视频编码",width:"120",align:"center"},{default:a(l=>[r("div",{class:ae(["mapped-cell",{"invalid-value":!X(l.row.video_codec)||!N("video_codec",l.row.video_codec)}])},f(ee("video_codec",l.row.video_codec)),3)]),_:1}),s(S,{prop:"audio_codec",label:"音频编码",width:"90",align:"center"},{default:a(l=>[r("div",{class:ae(["mapped-cell",{"invalid-value":!X(l.row.audio_codec)||!N("audio_codec",l.row.audio_codec)}])},f(ee("audio_codec",l.row.audio_codec)),3)]),_:1}),s(S,{prop:"resolution",label:"分辨率",width:"90",align:"center"},{default:a(l=>[r("div",{class:ae(["mapped-cell",{"invalid-value":!X(l.row.resolution)||!N("resolution",l.row.resolution)}])},f(ee("resolution",l.row.resolution)),3)]),_:1}),s(S,{prop:"team",label:"制作组",width:"120",align:"center"},{default:a(l=>[r("div",{class:ae(["mapped-cell",{"invalid-value":!X(l.row.team)||!N("team",l.row.team)}])},f(ee("team",l.row.team)),3)]),_:1}),s(S,{prop:"source",label:"产地",width:"100",align:"center"},{default:a(l=>[r("div",{class:ae(["mapped-cell",{"invalid-value":!X(l.row.source)||!N("source",l.row.source)}])},f(ee("source",l.row.source)),3)]),_:1}),s(S,{prop:"tags",label:"标签",align:"center",width:"170"},{default:a(l=>[r("div",ha,[(p(!0),_(Te,null,Ae(ct(l.row.tags),(Ne,At)=>(p(),M(V,{key:Ne,size:"small",type:Le(l.row.tags,At),class:ae(pt(l.row.tags,At)),style:{margin:"2px"}},{default:a(()=>[o(f(Ne),1)]),_:2},1032,["type","class"]))),128))])]),_:1}),s(S,{prop:"unrecognized",label:"无法识别",width:"120",align:"center"},{default:a(l=>[r("div",{class:ae(["mapped-cell",{"invalid-value":l.row.unrecognized}])},f(l.row.unrecognized||""),3)]),_:1}),s(S,{prop:"updated_at",label:"更新时间",width:"140",align:"center",sortable:""},{default:a(l=>[r("div",ya,f(l.row.is_deleted||R(l.row.tags)?L(l.row):Be(l.row.updated_at)),1)]),_:1}),s(S,{label:"操作",width:"130",align:"center",fixed:"right"},{default:a(l=>[s(c,{size:"small",type:"primary",onClick:Ne=>d(l.row)},{default:a(()=>[...e[36]||(e[36]=[o("编辑",-1)])]),_:1},8,["onClick"]),s(c,{size:"small",type:"danger",onClick:Ne=>n(l.row),style:{"margin-left":"5px"}},{default:a(()=>[...e[37]||(e[37]=[o("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data","max-height"])),[[Nt,Y.value]])]),vt.value?(p(),_("div",wa,[s(Me,{class:"cross-seed-card",shadow:"always"},{header:a(()=>[r("div",ba,[r("span",null,"转种 - "+f(mt.value),1),s(c,{type:"danger",circle:"",onClick:w,plain:""},{default:a(()=>[...e[38]||(e[38]=[o("X",-1)])]),_:1})])]),default:a(()=>[r("div",ka,[s(ys,{"show-complete-button":!0,onComplete:m,onCancel:w})])]),_:1})])):C("",!0),ke.value?(p(),_("div",Sa,[s(Me,{class:"batch-cross-seed-card",shadow:"always"},{header:a(()=>[r("div",xa,[e[40]||(e[40]=r("span",null,"批量转种",-1)),s(c,{type:"danger",circle:"",onClick:he,plain:""},{default:a(()=>[...e[39]||(e[39]=[o("X",-1)])]),_:1})])]),default:a(()=>[r("div",Da,[r("div",Ca,[r("div",$a,[r("p",null,[e[41]||(e[41]=r("strong",null,"目标站点：",-1)),o(f(z.value.excludeTargetSites),1)]),r("p",null,[e[42]||(e[42]=r("strong",null,"选中种子数量：",-1)),o(f(B.value.length)+" 个",1)]),e[43]||(e[43]=r("p",{style:{color:"#909399","font-size":"13px","margin-top":"10px"}}," 将把选中的种子转种到上述目标站点，请确认无误后点击确定。 ",-1))])])]),r("div",Ta,[s(c,{onClick:he},{default:a(()=>[...e[44]||(e[44]=[o("取消",-1)])]),_:1}),s(c,{type:"primary",onClick:Ee},{default:a(()=>[...e[45]||(e[45]=[o("确定",-1)])]),_:1})])]),_:1})])):C("",!0),O.value?(p(),_("div",za,[s(Me,{class:"record-view-card",shadow:"always"},{default:a(()=>[r("div",Ia,[r("div",Ra,[r("div",Ba,[r("div",{class:ae(["tab-item",{active:E.value==="cross-seed"}]),onClick:e[10]||(e[10]=l=>E.value="cross-seed")}," 批量转种记录 ",2),r("div",{class:ae(["tab-item",{active:E.value==="bdinfo"}]),onClick:e[11]||(e[11]=l=>E.value="bdinfo")}," BDInfo获取记录 ",2)]),r("div",Va,[s(c,{type:"danger",circle:"",onClick:Wt,plain:""},{default:a(()=>[...e[46]||(e[46]=[o("X",-1)])]),_:1})])]),s(ps,{modelValue:E.value,"onUpdate:modelValue":e[13]||(e[13]=l=>E.value=l),type:"border-card",class:"record-tabs","show-header":!1},{default:a(()=>[s(Mt,{label:"批量转种记录",name:"cross-seed"},{label:a(()=>[...e[47]||(e[47]=[r("span",null,"批量转种记录",-1)])]),default:a(()=>[r("div",Fa,[e[50]||(e[50]=r("div",{class:"record-warning-text"},"批量转种需要等待种子文件验证，每个种子大概3s",-1)),r("div",Pa,[s(c,{type:"warning",size:"small",onClick:Kt},{default:a(()=>[...e[48]||(e[48]=[o(" 清空记录 ",-1)])]),_:1}),s(c,{type:"danger",size:"small",onClick:ds,disabled:ne.value},{default:a(()=>[o(f(ne.value?"停止中...":"停止转种"),1)]),_:1},8,["disabled"]),s(c,{type:"success",size:"small",disabled:""},{default:a(()=>[...e[49]||(e[49]=[o(" 自动刷新中 ",-1)])]),_:1})])]),U.value.length>0?(p(),_("div",Ma,[st((p(),M(kt,{data:U.value,style:{width:"100%"},size:"small","element-loading-text":"加载记录中...",stripe:""},{default:a(()=>[s(S,{prop:"batch_id",label:"批次ID",width:"80",align:"center"},{default:a(l=>[s(V,{size:"small",type:as(Bt(l.row.batch_id)),effect:"dark"},{default:a(()=>[o(f(Bt(l.row.batch_id)),1)]),_:2},1032,["type"])]),_:1}),s(S,{prop:"title",label:"种子标题","min-width":"250",align:"center","show-overflow-tooltip":""}),s(S,{prop:"source_site",label:"源站点",width:"80",align:"center"}),s(S,{prop:"target_site",label:"目标站点",width:"80",align:"center"}),s(S,{prop:"video_size_gb",label:"视频大小",width:"80",align:"center"},{default:a(l=>[l.row.video_size_gb?(p(),_("span",Na,f(l.row.video_size_gb)+"GB",1)):(p(),_("span",Aa,"-"))]),_:1}),s(S,{prop:"status",label:"状态",width:"80",align:"center"},{default:a(l=>[s(V,{type:Yt(l.row.status),size:"small"},{default:a(()=>[o(f(Gt(l.row.status)),1)]),_:2},1032,["type"])]),_:1}),s(S,{prop:"progress",label:"进度",width:"100",align:"center"},{default:a(l=>[l.row.progress?(p(),_("div",La,[s(St,{percentage:Ft(l.row.progress),color:is(Ft(l.row.progress)),"stroke-width":8,"show-text":!1,class:"progress-bar"},null,8,["percentage","color"]),r("span",Oa,f(l.row.progress),1)])):(p(),_("span",Ua,"-"))]),_:1}),s(S,{prop:"error_detail",label:"详情",width:"110",align:"center","show-overflow-tooltip":""},{default:a(l=>[l.row.status==="success"&&l.row.success_url?(p(),_("span",Ea,[s(us,{type:"primary",href:os(l.row.success_url),target:"_blank"},{default:a(()=>[...e[51]||(e[51]=[o("查看详情页",-1)])]),_:1},8,["href"])])):l.row.error_detail?(p(),_("span",Ja,f(l.row.error_detail),1)):(p(),_("span",qa,"-"))]),_:1}),s(S,{prop:"downloader_add_result",label:"下载器状态",width:"150",align:"center"},{default:a(l=>[l.row.downloader_add_result?(p(),_(Te,{key:0},[ls(l.row.downloader_add_result)==="danger"?(p(),M(cs,{key:0,effect:"dark",placement:"top"},{content:a(()=>[o(f(Vt(l.row.downloader_add_result)),1)]),default:a(()=>[e[52]||(e[52]=r("span",{style:{color:"#f56c6c"}},"错误",-1))]),_:2},1024)):(p(),_("span",{key:1,style:vs([{"text-align":"center"},{color:ns(l.row.downloader_add_result)}])},f(Vt(l.row.downloader_add_result)),5))],64)):(p(),_("span",ja,"-"))]),_:1}),s(S,{prop:"processed_at",label:"处理时间",width:"100",align:"center"},{default:a(l=>[r("div",Xa,f(rs(l.row.processed_at)),1)]),_:1})]),_:1},8,["data"])),[[Nt,ue.value]])])):C("",!0),U.value.length===0&&!ue.value?(p(),_("div",Ha,[s(Pt,{description:"暂无批量转种记录"})])):C("",!0)]),_:1}),s(Mt,{label:"BDInfo获取记录",name:"bdinfo"},{label:a(()=>[...e[53]||(e[53]=[r("span",null,"BDInfo获取记录",-1)])]),default:a(()=>[r("div",Wa,[r("div",Ka,[s(I,{modelValue:j.value,"onUpdate:modelValue":e[12]||(e[12]=l=>j.value=l),onChange:Qt,size:"small"},{default:a(()=>[s(D,{label:""},{default:a(()=>[...e[54]||(e[54]=[o("全部",-1)])]),_:1}),s(D,{label:"processing"},{default:a(()=>[...e[55]||(e[55]=[o("获取中",-1)])]),_:1}),s(D,{label:"completed"},{default:a(()=>[...e[56]||(e[56]=[o("已完成",-1)])]),_:1}),s(D,{label:"failed"},{default:a(()=>[...e[57]||(e[57]=[o("失败",-1)])]),_:1})]),_:1},8,["modelValue"])]),r("div",Ya,[s(c,{type:"success",size:"small",disabled:""},{default:a(()=>[...e[58]||(e[58]=[o(" 自动刷新中 ",-1)])]),_:1})])]),G.value.length>0?(p(),_("div",Ga,[s(kt,{data:G.value,style:{width:"100%"},size:"small",stripe:""},{default:a(()=>[s(S,{prop:"title",label:"种子标题","show-overflow-tooltip":""}),s(S,{prop:"nickname",label:"站点",width:"100",align:"center"},{default:a(l=>[r("div",Qa,f(l.row.nickname),1)]),_:1}),s(S,{prop:"seed_id",label:"种子ID",width:"60",align:"center"},{default:a(l=>[r("span",null,f(l.row.seed_id.split("_")[1]),1)]),_:1}),s(S,{prop:"mediainfo_status",label:"状态",width:"80",align:"center"},{default:a(l=>[s(V,{type:$t(l.row.mediainfo_status),size:"small"},{default:a(()=>[o(f(Tt(l.row.mediainfo_status)),1)]),_:2},1032,["type"])]),_:1}),s(S,{prop:"bdinfo_started_at",label:"开始时间",width:"140",align:"center"},{default:a(l=>[l.row.bdinfo_started_at?(p(),_("span",Za,f(Be(l.row.bdinfo_started_at)),1)):(p(),_("span",el,"-"))]),_:1}),s(S,{prop:"duration",label:"耗时",width:"80",align:"center"},{default:a(l=>[l.row.mediainfo_status==="processing_bdinfo"&&l.row.progress_info?(p(),_("span",tl,f(l.row.progress_info.elapsed_time),1)):(p(),_("span",sl,f(zt(l.row)),1))]),_:1}),s(S,{label:"剩余时间",width:"100",align:"center"},{default:a(l=>[l.row.mediainfo_status==="processing_bdinfo"&&l.row.progress_info&&l.row.progress_info.remaining_time?(p(),_("span",al,f(l.row.progress_info.remaining_time),1)):(p(),_("span",ll,"-"))]),_:1}),s(S,{label:"进度",width:"100",align:"center"},{default:a(l=>[l.row.mediainfo_status==="processing_bdinfo"&&l.row.progress_info?(p(),_("div",nl,[s(St,{percentage:l.row.progress_info?.progress_percent||0,status:(l.row.progress_info?.progress_percent||0)===100?"success":"","stroke-width":6,"show-text":!1},null,8,["percentage","status"]),r("div",ol,f(l.row.progress_info?.progress_percent||0)+"% ",1)])):l.row.mediainfo_status==="completed"?(p(),_("div",rl,[s(St,{percentage:100,status:"success","stroke-width":6,"show-text":!1}),e[59]||(e[59]=r("div",{style:{"font-size":"12px","margin-top":"4px",color:"#606266"}},"100%",-1))])):(p(),_("span",il,"-"))]),_:1}),s(S,{label:"操作",width:"80",align:"center"},{default:a(l=>[s(c,{size:"small",type:"primary",onClick:Ne=>Zt(l.row)},{default:a(()=>[...e[60]||(e[60]=[o(" 详情 ",-1)])]),_:1},8,["onClick"]),ts(l.row)?(p(),M(c,{key:0,size:"small",type:"warning",onClick:Ne=>ss(l.row),style:{"margin-left":"0"},loading:Q.value.has(l.row.seed_id)},{default:a(()=>[...e[61]||(e[61]=[o(" 重试 ",-1)])]),_:1},8,["onClick","loading"])):C("",!0)]),_:1})]),_:1},8,["data"])])):C("",!0),G.value.length===0&&!Xe.value?(p(),_("div",dl,[s(Pt,{description:"暂无BDInfo获取记录"})])):C("",!0)]),_:1})]),_:1},8,["modelValue"])])]),_:1})])):C("",!0),pe.value?(p(),_("div",ul,[s(Me,{class:"bdinfo-detail-card",shadow:"always"},{header:a(()=>[r("div",cl,[r("span",null,"BDInfo详情 - "+f(T.value?.title),1),s(c,{type:"danger",circle:"",onClick:Rt,plain:""},{default:a(()=>[...e[62]||(e[62]=[o("X",-1)])]),_:1})])]),default:a(()=>[r("div",pl,[s(gs,{column:2,border:""},{default:a(()=>[s(be,{label:"种子标题"},{default:a(()=>[o(f(T.value?.title),1)]),_:1}),s(be,{label:"站点"},{default:a(()=>[o(f(T.value?.nickname),1)]),_:1}),s(be,{label:"状态"},{default:a(()=>[s(V,{type:$t(T.value?.mediainfo_status),size:"small"},{default:a(()=>[o(f(Tt(T.value?.mediainfo_status)),1)]),_:1},8,["type"])]),_:1}),s(be,{label:"任务ID"},{default:a(()=>[T.value?.bdinfo_task_id?(p(),_("div",fl,[r("span",null,f(T.value.bdinfo_task_id),1),s(c,{type:"text",size:"small",onClick:e[14]||(e[14]=l=>It(T.value.bdinfo_task_id)),style:{"margin-left":"5px",padding:"0"}},{default:a(()=>[s(fs,null,{default:a(()=>[s(Et(ms))]),_:1})]),_:1})])):(p(),_("span",gl,"-"))]),_:1}),s(be,{label:"开始时间"},{default:a(()=>[o(f(T.value?.bdinfo_started_at?Be(T.value.bdinfo_started_at):"-"),1)]),_:1}),s(be,{label:"完成时间"},{default:a(()=>[o(f(T.value?.bdinfo_completed_at?Be(T.value.bdinfo_completed_at):"-"),1)]),_:1}),s(be,{label:"耗时"},{default:a(()=>[o(f(zt(T.value)),1)]),_:1}),s(be,{label:"是否为BDInfo"},{default:a(()=>[s(V,{type:T.value?.is_bdinfo?"success":"info",size:"small"},{default:a(()=>[o(f(T.value?.is_bdinfo?"是":"否"),1)]),_:1},8,["type"])]),_:1})]),_:1}),T.value?.bdinfo_error?(p(),_("div",_l,[e[63]||(e[63]=r("h4",{style:{margin:"15px 0 10px 0",color:"#f56c6c"}},"错误信息",-1)),s(i,{title:T.value.bdinfo_error,type:"error",closable:!1,"show-icon":""},null,8,["title"])])):C("",!0),T.value?.mediainfo?(p(),_("div",vl,[r("h4",ml,f(T.value?.is_bdinfo?"BDInfo":"MediaInfo")+" 内容 ",1),s(u,{type:"textarea","model-value":T.value.mediainfo,rows:15,class:"code-font",readonly:""},null,8,["model-value"]),r("div",hl,[s(c,{type:"primary",size:"small",onClick:e[15]||(e[15]=l=>It(T.value.mediainfo))},{default:a(()=>[...e[64]||(e[64]=[o(" 复制内容 ",-1)])]),_:1})])])):C("",!0)]),r("div",yl,[s(c,{onClick:Rt},{default:a(()=>[...e[65]||(e[65]=[o("关闭",-1)])]),_:1})])]),_:1})])):C("",!0),Se.value?(p(),_("div",wl,[s(Me,{class:"batch-fetch-main-card",shadow:"always"},{header:a(()=>[r("div",bl,[e[67]||(e[67]=r("span",null,"批量获取种子数据",-1)),s(c,{type:"danger",circle:"",onClick:h,plain:""},{default:a(()=>[...e[66]||(e[66]=[o("X",-1)])]),_:1})])]),default:a(()=>[r("div",kl,[s(Zs,{onCancel:h,onFetchCompleted:Ce})])]),_:1})])):C("",!0)])}}}),Tl=jt(Dl,[["__scopeId","data-v-15787a18"]]);export{Tl as default};
